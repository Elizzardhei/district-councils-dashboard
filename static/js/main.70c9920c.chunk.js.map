{"version":3,"sources":["../node_modules/encoding/lib sync","constants/dcregion.js","components/StackedNormalizedHorizontalBarChart.js","components/CampCompareChartContainer.js","components/atoms/Text.js","pages/search/index.js","components/molecules/ScrollableTabs.js","ui/responsive.js","pages/profile/index.js","components/OLMap.js","components/district/DistrictCard.js","components/district/MainAreas.js","components/BorderLinearProgress.js","components/district/CandidateList.js","components/district/VoterTurnoutChart.js","components/charts/WaffleChart.js","components/district/Metrics.js","queries/gql.js","pages/district/index.js","components/DCCACompareMap.js","components/molecules/Card.js","components/atoms/Tag.js","components/atoms/UnstyledLink.js","components/district/Councillor.js","components/molecules/Dialog.js","components/district/CouncillorSelection.js","components/district/DCCAOverview.js","pages/battleground/index.js","ui/theme/index.js","pages/notfound/index.js","ui/theme/main.js","utils/features.js","components/AddressSearcher.js","reducers/drawer.js","ContextStore.js","components/search/DistrictSelector.js","components/search/SearchDrawer.js","components/molecules/MobileAppBar.js","App.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","DCREGION","A","zh_hk","en_us","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","StackedNormalizedHorizontalBarChart","data","margin","height","length","series","d3","columns","slice","offset","color","domain","map","d","key","range","unknown","y","name","padding","x","svg","append","attr","style","selectAll","enter","join","i","bandwidth","call","g","concat","ticks","width","remove","tickSizeOuter","this","props","drawChart","react_default","a","createElement","Fragment","Component","Container","styled","div","_templateObject","FETCH_CAMP_DATA","gql","_templateObject2","CampCompareChartContainer","react_apollo_esm","query","variables","year","_ref2","loading","error","dataForD3","res","建制","count","泛民","其他","total","Object","values","reduce","acc","c","convertToD3Compatible","candidates","byCodes","_","groupBy","candidate","cacode","r","defineProperty","camp","p","val","assign","forEach","k","groupDataByRegionAndCamp","dc_candidates","console","log","components_StackedNormalizedHorizontalBarChart","StyledSubtTitle","Typography","Text_templateObject","theme","subtextColor","TitleText","variant","SubTitleText","StyledDivier","Divider","search_templateObject","search_templateObject2","TopSection","_templateObject3","ExpandedRow","Box","_templateObject4","TabButton","Button","_templateObject5","main","backgroundColor","LandingIcon","_templateObject6","NoteHeader","_templateObject7","NoteContent","_templateObject8","SearchPage","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","state","autoCompleteList","type","onClick","onTabSelected","search_Container","Text_TitleText","Text_SubTitleText","components_CampCompareChartContainer","renderNote","renderFooter","withStyles","withTheme","TabPanel","children","value","index","other","objectWithoutProperties","component","role","hidden","aria-labelledby","a11yProps","aria-controls","ScrollableTabsButtonAuto","_React$useState","React","useState","_React$useState2","slicedToArray","setValue","AppBar","position","Tabs","onChange","event","newValue","indicatorColor","textColor","scrollButtons","aria-label","Tab","label","bps","createBreakpoints","createMuiTheme","GET_PEOPLE_PROFILE","profile_templateObject","FlexRowContainer","profile_templateObject2","up","profile_templateObject3","CandidateHeaderContainer","profile_templateObject4","CandidateAvatar","Avatar","profile_templateObject5","PersonName","profile_templateObject6","YearDiv","profile_templateObject7","profile_templateObject8","_templateObject9","_templateObject10","PersonHighlight","_templateObject11","ElectionHistoryPaper","Paper","_templateObject12","ElectionHistoryContentGrid","Grid","_templateObject13","ElectionHistoryContentSpan","_templateObject14","ElectionHistoryContentHeaderSpan","_templateObject15","ElectionDetailButton","_templateObject16","ProfilePage","_templateObject17","_templateObject18","handleElectionDetailButton","history","push","election","yob","_this2","item","xs","md","container","spacing","constituency","name_zh","vote_percentage","is_won","match","params","homeUrl","_ref","person","dcd_people","currentTerm","councilors","lastElection","personHighlight","estimated_yob","title","text","political_affiliation","career","occupation","sm","src","uuid","imgProps","onError","target","marginBottom","name_en","district","dc_name_zh","highlight","MapContainer","OLMap_templateObject","regionStyle","Style","fill","Fill","stroke","Stroke","Text","font","highlightStyle","OLMap","handleMapClick","_this$props","changeDistrict","selectedFeature","getFeatures","highlightFeature","get","getView","fit","getGeometry","getExtent","duration","featuresLayer","_this$props2","dc","dc2003","dc2007","dc2011","dc2015","dc2019","find","isDCDataExist","featureSource","VectorSource","features","GeoJSON","readFeatures","VectorLayer","source","feature","getText","setText","getProperties","CNAME","layers","TileLayer","XYZ","url","Map","refs","mapContainer","view","View","projection","center","zoom","featureOverlay","CACODE","extent","size","getSize","setState","select","Select","addInteraction","on","highlightedFeature","getSource","removeFeature","addFeature","ref","DistrictCard_templateObject","down","InnerContainer","DistrictCard_templateObject2","YearText","DistrictCard_templateObject3","RegionText","DistrictCard_templateObject4","CodeText","DistrictCard_templateObject5","DistrictCard_templateObject6","SeperatedRow","DistrictCard_templateObject7","DistrictCard","IconButton","onPrevElection","ArrowBack_default","Date","getFullYear","onNextElection","ArrowForward_default","stations","councilor","DistrictCard_Container","border","renderPrevElectionButton","gutterBottom","renderNextElectionButton","DistrictCard_StyledDivier","station","MainAreas_templateObject","MainAreas","areas","MainAreas_Container","display","flexWrap","alignContent","area","mr","useStyles","makeStyles","root","flexGrow","BorderLinearProgress","lighten","bgcolor","bar","borderRadius","LinearProgress","CustomizedProgressBars","classes","className","fontBoldStyle","css","CandidateList_templateObject","fontNormalStyle","CandidateList_templateObject2","OvalButton","CandidateList_templateObject3","CandidateList_templateObject4","RowsContainer","CandidateList_templateObject5","CandidateList_templateObject6","FlexColumn","CandidateList_templateObject7","AvatarColumn","CandidateList_templateObject8","NameColumn","CandidateList_templateObject9","PoliticalColumn","CandidateList_templateObject10","CandidateList_templateObject11","CandidateListTitle","CandidateList_templateObject12","CandidateName","CandidateList_templateObject13","BlueVoteContainer","CandidateList_templateObject14","RedVoteContainer","CandidateList_templateObject15","ContentHeader","CandidateList_templateObject16","Content","CandidateList_templateObject17","CandidateList","CandidateList_Container","maxWidth","sort","b","candidate_number","CandidateList_StyledDivier","CandidateList_FlexRowContainer","handleCandidateSelected","votes","parseFloat","zingchart","MODULESDIR","chartJSON","chartData","male","female","titles","split","filter","isNaN","parseInt","stacked","stack-type","align","subtitle","bold","font-size","font-color","background-color","plot","bar-width","hover-state","visible","animation","delay","sequence","valueBox","rules","rule","decimals","scale-x","tick","guide","scale-y","short","line-color","line-style","tooltip","VoterTurnoutChart","render","nextProps","nextState","JSON","stringify","exec","WaffleChart","squareValue","theData","population","units","Math","round","percentage","floor","Array","groupIndex","squareSize","row","col","legend","QUERY_FETCH_VOTES","Metrics_templateObject","Metrics_templateObject2","_data$dc_constituenci","dc_constituencies","vote_stat","voteStats","voteStat","total_votes","total_voters","total_voted_voters","population_excluded_foreign_worker","population_excluded_foreign_worker_lte_age_15","_ref$person","getDataForWaffleChart","stats","station_stats","barVote","cur","age","gender","Metrics_Container","district_VoterTurnoutChart","charts_WaffleChart","CONSTITUENCIES_DATA","QUERY_CONSTITUENCIES","gql_templateObject","FullWidthBox","district_templateObject","LowerBackgroundContainer","district_templateObject2","district_templateObject3","DistrictCardContainer","district_templateObject4","DistrictPage","candidateId","handleChangeDistrict","_this$props$match$par","_this$props$match$par2","_this$props$match$par3","district_FlexRowContainer","components_OLMap","dcd_constituencies","district_DistrictCard","bind","district_MainAreas","main_areas","Metrics","district_CandidateList","DCCACompareMap_templateObject","DCCACompareMap","DCCACompareMap_MapContainer","StyledCard","Card","Card_templateObject","PlainCard","StyledChip","Chip","Tag_templateObject","Tag","handleClick","Link","UnstyledLink_templateObject","UnstyledNavLink","NavLink","UnstyledLink_templateObject2","StyledAvatar","Councillor_templateObject","Councillor","to","Card_PlainCard","Tag_Tag","wrap","pr","alignSelf","StyledDialogTitle","MuiDialogTitle","Dialog_templateObject","StyledDialogContent","MuiDialogContent","Dialog_templateObject2","DialogTitle","onClose","alignItems","Close_default","DialogContent","PlainDialog","open","handleClose","content","actions","Dialog","Dialog_DialogTitle","Dialog_DialogContent","DialogActions","CustomizedDialogs","setOpen","Add_default","fontSize","Dialog_PlainDialog","DCCAOverview_templateObject","DCCAOverview","tags","voterData","new_voters_percentage","aggregations","new_voters","all_voters","toFixed","DCCAOverview_Container","tag","marginLeft","battleground_templateObject","battleground_templateObject2","battleground_templateObject3","groupVoteStat","stat","subtype","VOTERS","v","NEW_VOTERS","BattleGroundPage","showMap","lastElectionYear","last_district","last_dcd_constituencies","district_DCCAOverview","vote_stats","ExpandMore_default","Collapse","in","components_DCCACompareMap","district_Councillor","typography","useNextVariants","fontFamily","h1","h2","fontWeight","h3","h4","h5","h6","body1","palette","primary","light","dark","secondary","background","default","button","NotFoundPage","MuiThemeProvider_default","href","body2","contrastText","styledComponentTheme","secondaryBackgroundColor","getAllFeaturesFromPoint","point","featuresArray","arguments","undefined","pt","turf","lng","lat","polygonProps","n","poly","geometry","coordinates","objectSpread","properties","renderInputComponent","inputProps","_inputProps$inputRef","inputRef","TextField","fullWidth","InputProps","node","input","disableUnderline","endAdornment","InputAdornment","searchButton","Search_default","renderSuggestion","suggestion","isHighlighted","matches","parts","parse","MenuItem","selected","part","String","getSuggestionValue","IntegrationAutosuggest","suggestions","handleSuggestionsFetchRequested","getSuggestions","then","result","handleSuggestionsClearRequested","handleChange","_ref3","handleSuggestionSelected","_ref4","suggestionValue","suggestionIndex","sectionIndex","method","handleAddressSelected","coordinate","inputValue","trim","toLowerCase","AddressParser","records","record","fullAddress","LANG_ZH","autosuggestProps","onSuggestionsFetchRequested","onSuggestionsClearRequested","onSuggestionSelected","dist_default","placeholder","popperNode","InputLabelProps","shrink","suggestionsList","suggestInput","renderSuggestionsContainer","options","square","containerProps","suggestionsContainerOpen","zIndex","marginTop","listStyleType","boxShadow","textDecoration","DRAWER_OPEN","DRAWER_CLOSE","drawer","action","drawerInitialState","ContextStore","createContext","DistrictSelector_templateObject","DistrictContainer","DistrictSelector_templateObject2","DistrictSelector_templateObject3","withRouter","dispatch","useContext","DistrictSelector_Container","ExpansionPanel","dccode","ExpansionPanelSummary","dname_chi","ExpansionPanelDetails","dcca","SearchDrawer_templateObject","SearchDrawer_templateObject2","SearchDrawer_templateObject3","ContentRowContainer","SearchDrawer_templateObject4","ContentContainer","SearchDrawer_templateObject5","AddressSearchContainer","SearchDrawer_templateObject6","TabContainer","SearchDrawer_templateObject7","SearchDrawer_templateObject8","active","NavBarButton","SearchDrawer_templateObject9","selectedTab","setSelectedTab","lastest","pop","onDrawerClose","tab","SearchDrawer_Container","SearchDrawer_TabButton","SearchDrawer_StyledDivier","AddressSearcher","search_DistrictSelector","StyledAppBar","MobileAppBar_templateObject","StyledToolbar","Toolbar","MobileAppBar_templateObject2","AppBarTitle","MobileAppBar_templateObject3","forwardRef","Slide","direction","displayName","MobileAppBar","disableGutters","Menu_default","client","ApolloClient","uri","paper","App_templateObject","Root","App_templateObject2","App","_React$useReducer","useReducer","drawerReducer","_React$useReducer2","drawerState","drawerDispatch","styled_components_browser_esm","src_ContextStore","Provider","App_ContentContainer","CssBaseline","molecules_MobileAppBar","react_router","exact","path","NotfoundPage","Drawer","anchor","search_SearchDrawer","ReactDOM","react_router_dom","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.70c9920c.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 387;","// deprecated. should use the data from server\r\nexport const DCREGION = {\r\n  A: {\r\n    zh_hk: '中西區',\r\n    en_us: 'Central and Western',\r\n  },\r\n  B: {\r\n    zh_hk: '灣仔',\r\n    en_us: 'Wan Chai',\r\n  },\r\n  C: {\r\n    zh_hk: '東區',\r\n    en_us: 'Eastern',\r\n  },\r\n  D: {\r\n    zh_hk: '南區',\r\n    en_us: 'Southern',\r\n  },\r\n  E: {\r\n    zh_hk: '油尖旺',\r\n    en_us: 'Yau Tsim Mong',\r\n  },\r\n  F: {\r\n    zh_hk: '深水埗',\r\n    en_us: 'Sham Shui Po',\r\n  },\r\n  G: {\r\n    zh_hk: '九龍城',\r\n    en_us: 'Kowloon City',\r\n  },\r\n  H: {\r\n    zh_hk: '黃大仙',\r\n    en_us: 'Wong Tai Sin',\r\n  },\r\n  J: {\r\n    zh_hk: '觀塘',\r\n    en_us: 'Kwun Tong',\r\n  },\r\n  K: {\r\n    zh_hk: '荃灣',\r\n    en_us: 'Tsuen Wan',\r\n  },\r\n  L: {\r\n    zh_hk: '屯門',\r\n    en_us: 'Tuen Mun',\r\n  },\r\n  M: {\r\n    zh_hk: '元朗',\r\n    en_us: 'Yuen Long',\r\n  },\r\n  N: {\r\n    zh_hk: '北區',\r\n    en_us: 'North',\r\n  },\r\n  P: {\r\n    zh_hk: '大埔',\r\n    en_us: 'Tai Po',\r\n  },\r\n  Q: {\r\n    zh_hk: '西貢',\r\n    en_us: 'Sai Kung',\r\n  },\r\n  R: {\r\n    zh_hk: '沙田',\r\n    en_us: 'Sha Tin',\r\n  },\r\n  S: {\r\n    zh_hk: '葵青',\r\n    en_us: 'Kwai Tsing',\r\n  },\r\n  T: {\r\n    zh_hk: '離島',\r\n    en_us: 'Islands',\r\n  },\r\n}\r\n","import React, { Component } from 'react'\r\nimport * as d3 from 'd3'\r\n\r\nconst ROW_HEIGHT = 50\r\n\r\nclass StackedNormalizedHorizontalBarChart extends Component {\r\n  drawChart(data) {\r\n    const margin = { top: 30, right: 10, bottom: 0, left: 50 }\r\n    const height = data.length * ROW_HEIGHT + margin.top + margin.bottom\r\n    const width = 1000\r\n\r\n    const series = d3\r\n      .stack()\r\n      .keys(data.columns.slice(1))\r\n      .offset(d3.stackOffsetExpand)(data)\r\n\r\n    const yAxis = g =>\r\n      g\r\n        .style('font', '24px times')\r\n        .attr('transform', `translate(${margin.left},0)`)\r\n        .call(d3.axisLeft(y).tickSizeOuter(0))\r\n        .call(g => g.selectAll('.domain').remove())\r\n\r\n    const xAxis = g =>\r\n      g\r\n        .style('font', '24px times')\r\n        .attr('transform', `translate(0,${margin.top})`)\r\n        .call(d3.axisTop(x).ticks(width / 100, '%'))\r\n        .call(g => g.selectAll('.domain').remove())\r\n\r\n    const color = d3\r\n      .scaleOrdinal()\r\n      .domain(series.map(d => d.key))\r\n      .range(['#ea3c53', '#eeeeee', '#63b9e9'])\r\n      .unknown('#ccc')\r\n\r\n    const y = d3\r\n      .scaleBand()\r\n      .domain(data.map(d => d.name))\r\n      .range([margin.top, height - margin.bottom])\r\n      .padding(0.1)\r\n\r\n    const x = d3.scaleLinear().range([margin.left, width - margin.right])\r\n\r\n    const svg = d3\r\n      .select('#stacked')\r\n      .append('svg')\r\n      .attr('viewBox', [0, 0, width, height])\r\n      .style('overflow', 'visible')\r\n\r\n    svg\r\n      .append('g')\r\n      .selectAll('g')\r\n      .data(series)\r\n      .enter()\r\n      .append('g')\r\n      .attr('fill', d => color(d.key))\r\n      .selectAll('rect')\r\n      .data(d => d)\r\n      .join('rect')\r\n      .attr('x', d => x(d[0]))\r\n      .attr('y', (d, i) => y(d.data.name))\r\n      .attr('width', d => x(d[1]) - x(d[0]))\r\n      .attr('height', y.bandwidth())\r\n\r\n    svg.append('g').call(xAxis)\r\n\r\n    svg.append('g').call(yAxis)\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { data } = this.props\r\n    this.drawChart(data)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <div id=\"stacked\" style={{ height: 'auto', width: '100%' }}></div>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default StackedNormalizedHorizontalBarChart\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport gql from 'graphql-tag'\r\nimport { Query } from 'react-apollo'\r\nimport _ from 'lodash'\r\nimport { DCREGION } from '../constants/dcregion'\r\nimport StackedNormalizedHorizontalBarChart from './StackedNormalizedHorizontalBarChart'\r\n\r\nconst Container = styled.div`\r\n  && {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: row;\r\n  }\r\n`\r\n\r\nconst FETCH_CAMP_DATA = gql`\r\n  query fetch_camp_data($year: Int!) {\r\n    dcd_candidates(where: { is_won: { _eq: true }, year: { _eq: $year } }) {\r\n      cacode\r\n      camp\r\n      person {\r\n        name_zh\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nfunction groupDataByRegionAndCamp(candidates) {\r\n  const byCodes = _.groupBy(candidates, candidate => candidate.cacode[0])\r\n  return Object.keys(byCodes).map(code => ({\r\n    code,\r\n    count: byCodes[code]\r\n      .map(r => ({ [r.camp]: 1 }))\r\n      .reduce((p, c) => {\r\n        const val = Object.assign(p)\r\n        Object.keys(c).forEach(k => (val[k] = c[k] + (val[k] ? val[k] : 0)))\r\n        return val\r\n      }, {}),\r\n  }))\r\n}\r\n\r\nfunction convertToD3Compatible(data) {\r\n  var res = data.map(d => {\r\n    return {\r\n      name: DCREGION[d.code].zh_hk,\r\n      建制: d.count['建制'] || 0,\r\n      泛民: d.count['泛民'] || 0,\r\n      其他: d.count['其他'] || 0,\r\n      total: Object.values(d.count).reduce((acc, c) => {\r\n        acc += c\r\n        return acc\r\n      }, 0),\r\n    }\r\n  })\r\n  res['columns'] = ['name', '建制', '其他', '泛民']\r\n  return res\r\n}\r\n\r\nconst CampCompareChartContainer = props => {\r\n  return (\r\n    <Query query={FETCH_CAMP_DATA} variables={{ year: 2015 }}>\r\n      {({ loading, error, data }) => {\r\n        if (loading) return null\r\n        if (error) return `Error! ${error}`\r\n        const dataFroGraph = groupDataByRegionAndCamp(data.dc_candidates)\r\n        const dataForD3 = convertToD3Compatible(dataFroGraph)\r\n        console.log(dataForD3)\r\n        return (\r\n          <Container>\r\n            <StackedNormalizedHorizontalBarChart\r\n              data={dataForD3}\r\n            ></StackedNormalizedHorizontalBarChart>\r\n          </Container>\r\n        )\r\n      }}\r\n    </Query>\r\n  )\r\n}\r\nexport default CampCompareChartContainer\r\n","import styled from 'styled-components'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport React from 'react'\r\n\r\nconst StyledSubtTitle = styled(Typography)`\r\n  && {\r\n    color: ${props => props.theme.subtextColor};\r\n  }\r\n`\r\n\r\nexport const TitleText = props => {\r\n  return <Typography variant=\"h2\" {...props} />\r\n}\r\n\r\nexport const SubTitleText = props => {\r\n  return <StyledSubtTitle variant=\"h3\" {...props} />\r\n}\r\n","import React, { Component } from 'react'\r\n\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport Box from '@material-ui/core/Box'\r\nimport Button from '@material-ui/core/Button'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport CampCompareChartContainer from 'components/CampCompareChartContainer'\r\nimport styled from 'styled-components'\r\n\r\nimport { TitleText, SubTitleText } from 'components/atoms/Text'\r\n\r\nconst styles = theme => ({})\r\n\r\nconst StyledDivier = styled(Divider)`\r\n  && {\r\n    background-color: #ececec;\r\n    width: 100%;\r\n    margin-top: 30px;\r\n    margin-bottom: 20px;\r\n  }\r\n`\r\n\r\nconst Container = styled.div`\r\n  width: 100%;\r\n  padding-top: 30px;\r\n  margin: auto;\r\n  display: flex;\r\n  flex-direction: row;\r\n  flex-wrap: wrap;\r\n  align-items: baseline;\r\n  padding-left: 16px;\r\n  padding-right: 16px;\r\n  flex-grow: 1;\r\n`\r\n\r\nconst TopSection = styled(Container)`\r\n  && {\r\n    background-color: #f2f2f3;\r\n  }\r\n`\r\n\r\nconst ExpandedRow = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    flex-grow: 1;\r\n  }\r\n`\r\n\r\nconst TabButton = styled(Button)`\r\n  && {\r\n    width: 136px;\r\n    height: 52px;\r\n    border-radius: 2px;\r\n    box-shadow: 1px 1px 6px 1px rgba(51, 51, 51, 0.1);\r\n    background-color: ${props => props.theme.main.backgroundColor};\r\n    text-align: center;\r\n\r\n    &:hover {\r\n      text-decoration: none;\r\n    }\r\n  }\r\n`\r\n\r\nconst LandingIcon = styled.div`\r\n  margin-top: 70px;\r\n  margin-left: auto;\r\n  margin-right: auto;\r\n  width: 200px;\r\n  height: 128px;\r\n  background: url('/static/images/landingIcon.svg') no-repeat;\r\n  background-size: cover;\r\n`\r\n\r\nconst NoteHeader = styled(TitleText)`\r\n  && {\r\n    text-align: center;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst NoteContent = styled(Typography)`\r\n  && {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nclass SearchPage extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      autoCompleteList: [],\r\n    }\r\n  }\r\n\r\n  async componentDidMount() {}\r\n\r\n  renderNote() {\r\n    return (\r\n      <>\r\n        <NoteHeader>為什麼你的一票很重要？</NoteHeader>\r\n        <NoteContent>\r\n          除非你有投票權、競選公職權，並且參與政治，否則政府不會回應你的利益。如果自己支持的人當選，即使自己的一票不會影響勝選結果，\r\n        </NoteContent>\r\n      </>\r\n    )\r\n  }\r\n\r\n  onTabSelected(type) {}\r\n\r\n  renderFooter() {\r\n    return <></>\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <TopSection>\r\n          <ExpandedRow>\r\n            <TabButton onClick={this.onTabSelected('district')}>\r\n              <Typography variant=\"h4\">找選區</Typography>\r\n            </TabButton>\r\n            <TabButton onClick={this.onTabSelected('people')}>\r\n              <Typography variant=\"h4\">找議員</Typography>\r\n            </TabButton>\r\n          </ExpandedRow>\r\n          <LandingIcon />\r\n        </TopSection>\r\n        <Container>\r\n          <ExpandedRow>\r\n            <TitleText>議會觀測</TitleText>\r\n            <SubTitleText>了解更多</SubTitleText>\r\n          </ExpandedRow>\r\n          <CampCompareChartContainer />\r\n          <StyledDivier />\r\n          <ExpandedRow>\r\n            <TitleText>熱門議題</TitleText>\r\n            <SubTitleText>所有議題</SubTitleText>\r\n          </ExpandedRow>\r\n          <StyledDivier />\r\n          {this.renderNote()}\r\n          {this.renderFooter()}\r\n        </Container>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(SearchPage)\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Tabs from '@material-ui/core/Tabs'\r\nimport Tab from '@material-ui/core/Tab'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Box from '@material-ui/core/Box'\r\n\r\nfunction TabPanel(props) {\r\n  const { children, value, index, ...other } = props\r\n\r\n  return (\r\n    <Typography\r\n      component=\"div\"\r\n      role=\"tabpanel\"\r\n      hidden={value !== index}\r\n      id={`scrollable-auto-tabpanel-${index}`}\r\n      aria-labelledby={`scrollable-auto-tab-${index}`}\r\n      {...other}\r\n    >\r\n      <Box p={3}>{children}</Box>\r\n    </Typography>\r\n  )\r\n}\r\n\r\nTabPanel.propTypes = {\r\n  children: PropTypes.node,\r\n  index: PropTypes.any.isRequired,\r\n  value: PropTypes.any.isRequired,\r\n}\r\n\r\nfunction a11yProps(index) {\r\n  return {\r\n    id: `scrollable-auto-tab-${index}`,\r\n    'aria-controls': `scrollable-auto-tabpanel-${index}`,\r\n  }\r\n}\r\n\r\nexport default function ScrollableTabsButtonAuto(props) {\r\n  console.log(props)\r\n  const [value, setValue] = React.useState(0)\r\n\r\n  function handleChange(event, newValue) {\r\n    setValue(newValue)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <AppBar position=\"static\">\r\n        <Tabs\r\n          value={value}\r\n          onChange={handleChange}\r\n          indicatorColor=\"primary\"\r\n          textColor=\"primary\"\r\n          variant=\"scrollable\"\r\n          scrollButtons=\"auto\"\r\n          aria-label=\"scrollable auto tabs example\"\r\n        >\r\n          <Tab label=\"Item One\" {...a11yProps(0)} />\r\n          <Tab label=\"Item Two\" {...a11yProps(1)} />\r\n          <Tab label=\"Item Three\" {...a11yProps(2)} />\r\n          <Tab label=\"Item Four\" {...a11yProps(3)} />\r\n          <Tab label=\"Item Five\" {...a11yProps(4)} />\r\n          <Tab label=\"Item Six\" {...a11yProps(5)} />\r\n          <Tab label=\"Item Seven\" {...a11yProps(6)} />\r\n        </Tabs>\r\n      </AppBar>\r\n      <TabPanel value={value} index={0}>\r\n        Item One\r\n      </TabPanel>\r\n      <TabPanel value={value} index={1}>\r\n        Item Two\r\n      </TabPanel>\r\n      <TabPanel value={value} index={2}>\r\n        Item Three\r\n      </TabPanel>\r\n      <TabPanel value={value} index={3}>\r\n        Item Four\r\n      </TabPanel>\r\n      <TabPanel value={value} index={4}>\r\n        Item Five\r\n      </TabPanel>\r\n      <TabPanel value={value} index={5}>\r\n        Item Six\r\n      </TabPanel>\r\n      <TabPanel value={value} index={6}>\r\n        Item Seven\r\n      </TabPanel>\r\n    </>\r\n  )\r\n}\r\n","import createBreakpoints from '@material-ui/core/styles/createBreakpoints'\r\nimport createMuiTheme from '@material-ui/core/styles/createMuiTheme'\r\n\r\nexport const bps = createBreakpoints({})\r\n\r\nexport const headingFontFamily = 'Source Serif Pro, sans-serif'\r\nexport const bodyFontFamily = 'PT Serif, sans-serif'\r\n\r\nexport const fontFamily = ['PingFangTC-Semibold', 'PingFangTC-Medium']\r\n\r\nexport const typography = {}\r\n\r\nexport const theme = createMuiTheme()\r\n","import React, { Component } from 'react'\r\nimport Box from '@material-ui/core/Box'\r\nimport styled, { css } from 'styled-components'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport ScrollableTabsButtonAuto from '../../components/molecules/ScrollableTabs'\r\nimport gql from 'graphql-tag'\r\nimport { Query } from 'react-apollo'\r\nimport { bps } from 'ui/responsive'\r\n\r\n// TODO: add age, camp & political_affiliation\r\nconst GET_PEOPLE_PROFILE = gql`\r\n  query($id: Int!) {\r\n    dcd_people(where: { id: { _eq: $id } }) {\r\n      id\r\n      uuid\r\n      name_zh\r\n      name_en\r\n      gender\r\n      estimated_yob\r\n      councilors {\r\n        year\r\n        cacode\r\n        career\r\n        district {\r\n          dc_name_zh\r\n        }\r\n        political_affiliation\r\n        post\r\n        constituency {\r\n          id\r\n          name_zh\r\n        }\r\n      }\r\n      candidates {\r\n        candidate_number\r\n        is_won\r\n        occupation\r\n        political_affiliation\r\n        age\r\n        cacode\r\n        camp\r\n        election_type\r\n        year\r\n      }\r\n    }\r\n  }\r\n`\r\n\r\nconst DistrictName = styled.div`\r\n   {\r\n    font-size: 14px;\r\n    font-weight: 600;\r\n    color: #ffffff;\r\n    ${bps.up('sm')} {\r\n      font-size: 20px;\r\n    }\r\n\r\n    ${bps.up('md')} {\r\n      font-size: 36px;\r\n    }\r\n  }\r\n`\r\n\r\nconst FlexRowContainer = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst CandidateHeaderContainer = styled(FlexRowContainer)`\r\n  && {\r\n    height: 84px;\r\n    position: relative;\r\n    display: flex;\r\n    background-color: #f6416e;\r\n  }\r\n`\r\n\r\nconst CandidateAvatar = styled(Avatar)`\r\n  && {\r\n    position: absolute;\r\n    left: 16px;\r\n    bottom: -16px;\r\n    width: 84px;\r\n    height: 84px;\r\n  }\r\n`\r\n\r\nconst PersonName = styled.div`\r\n   {\r\n    position: absolute;\r\n    left: 116px;\r\n    top: 32px;\r\n  }\r\n`\r\n\r\nconst BasicInfoHeader = styled.div`\r\n  && {\r\n    font-size: 32px;\r\n    font-weight: 600;\r\n    width: 100%;\r\n\r\n    ${bps.up('md')} {\r\n      margin-left: 65px;\r\n    }\r\n  }\r\n`\r\nconst ElectionHistoryContainer = styled(FlexRowContainer)`\r\n  && {\r\n    padding: 20px;\r\n    background-color: #fafafa;\r\n    ${bps.up('sm')} {\r\n      padding-left: 40px;\r\n    }\r\n\r\n    ${bps.up('md')} {\r\n      padding-left: 120px;\r\n      height: 100%;\r\n    }\r\n  }\r\n`\r\nconst ElectionHistoryHeader = styled.div`\r\n  && {\r\n    font-size: 32px;\r\n    font-weight: 600;\r\n    color: #333333;\r\n    margin-top: 4px;\r\n  }\r\n`\r\n\r\nconst YearDiv = styled.div`\r\n  && {\r\n    font-size: 24px;\r\n    font-weight: 600;\r\n    color: #9b9b9b;\r\n    margin-bottom: 20px;\r\n  }\r\n`\r\n\r\nconst PersonHighlight = styled.div`\r\n  && {\r\n    margin-top: 24px;\r\n    display: flex;\r\n  }\r\n`\r\nconst ElectionHistoryPaper = styled(Paper)`\r\n  && {\r\n    padding: 20px;\r\n  }\r\n`\r\n\r\nconst ElectionHistoryContentGrid = styled(Grid)`\r\n  && {\r\n    padding: 15px;\r\n  }\r\n`\r\n\r\nconst ElectionHistoryContentSpan = styled(Grid)`\r\n  && {\r\n    font-size: 18px;\r\n    color: #4a4a4a;\r\n  }\r\n`\r\n\r\nconst ElectionHistoryContentHeaderSpan = styled(ElectionHistoryContentSpan)`\r\n  && {\r\n    font-weight: 500;\r\n  }\r\n`\r\nconst ElectionDetailButton = styled.div`\r\n  && {\r\n    padding: 15px;\r\n    font-weight: 600;\r\n    color: #ffb700;\r\n    width: 100%;\r\n    text-align: center;\r\n    border-radius: 4px;\r\n    border: 2px solid #ffb700;\r\n    cursor: pointer;\r\n  }\r\n`\r\n\r\nconst BasicInfoGridHeader = styled(Grid)`\r\n  && {\r\n    font-weight: 600;\r\n    color: #4a4a4a;\r\n    font-size: 18px;\r\n  }\r\n`\r\n\r\nconst BasicInfoGridContent = styled(Grid)`\r\n  && {\r\n    color: #4a4a4a;\r\n    font-size: 18px;\r\n  }\r\n`\r\nclass ProfilePage extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {}\r\n  }\r\n\r\n  async componentDidMount() {}\r\n\r\n  handleElectionDetailButton = (year, code) => {\r\n    this.props.history.push(`/district/${year}/${code}`)\r\n  }\r\n\r\n  renderElectionInfoCard(election, yob) {\r\n    return (\r\n      <Grid item xs={12} md={4}>\r\n        <YearDiv>{`${election.year}年`}</YearDiv>\r\n        <ElectionHistoryPaper>\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionHistoryContentHeaderSpan item xs={12} md={4}>\r\n              地區\r\n            </ElectionHistoryContentHeaderSpan>\r\n            <ElectionHistoryContentSpan item xs={12} md={8}>\r\n              {' '}\r\n              {election.constituency && election.constituency.name\r\n                ? election.constituency.name\r\n                : '-'}{' '}\r\n            </ElectionHistoryContentSpan>\r\n          </ElectionHistoryContentGrid>\r\n          <hr />\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionHistoryContentHeaderSpan item xs={12} md={4}>\r\n              選區\r\n            </ElectionHistoryContentHeaderSpan>\r\n            <ElectionHistoryContentSpan item xs={12} md={8}>\r\n              {`${election.constituency.name_zh} （${election.cacode}）`}\r\n            </ElectionHistoryContentSpan>\r\n          </ElectionHistoryContentGrid>\r\n          <hr />\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionHistoryContentHeaderSpan item xs={12} md={4}>\r\n              陣營\r\n            </ElectionHistoryContentHeaderSpan>\r\n            <ElectionHistoryContentSpan item xs={12} md={8}>\r\n              {election.camp ? election.camp : '-'}\r\n            </ElectionHistoryContentSpan>\r\n          </ElectionHistoryContentGrid>\r\n          <hr />\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionHistoryContentHeaderSpan item xs={12} md={4}>\r\n              得票率\r\n            </ElectionHistoryContentHeaderSpan>\r\n            <ElectionHistoryContentSpan item xs={12} md={8}>\r\n              {`${election.vote_percentage}% （${\r\n                election.is_won ? '當選' : '落敗'\r\n              }）`}\r\n            </ElectionHistoryContentSpan>\r\n          </ElectionHistoryContentGrid>\r\n          <ElectionHistoryContentGrid container spacing={1}>\r\n            <ElectionDetailButton\r\n              onClick={() => {\r\n                this.handleElectionDetailButton(election.year, election.cacode)\r\n              }}\r\n            >\r\n              查看選舉資料\r\n            </ElectionDetailButton>\r\n          </ElectionHistoryContentGrid>\r\n        </ElectionHistoryPaper>\r\n      </Grid>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      match: {\r\n        params: { id },\r\n      },\r\n    } = this.props\r\n\r\n    // todo: use ENV_VAR\r\n    const homeUrl = 'https://cswbrian.github.io/district-councils-dashboard/'\r\n\r\n    return (\r\n      <Query query={GET_PEOPLE_PROFILE} variables={{ id }}>\r\n        {({ loading, error, data }) => {\r\n          if (loading) return null\r\n          if (error) return `Error! ${error}`\r\n          const person = data.dcd_people[0]\r\n\r\n          const currentTerm =\r\n            person.councilors && person.councilors[person.councilors.length - 1]\r\n          const lastElection =\r\n            person.candidates && person.candidates[person.candidates.length - 1]\r\n\r\n          const tabs = [\r\n            {\r\n              label: '履歷',\r\n              content: '123',\r\n            },\r\n            {\r\n              label: '立場',\r\n              content: '123',\r\n            },\r\n            {\r\n              label: '利益申報',\r\n              content: '123',\r\n            },\r\n          ]\r\n\r\n          const personHighlight = []\r\n\r\n          if (person.estimated_yob) {\r\n            personHighlight.push({\r\n              title: '年齡',\r\n              text: `${2019 - person.estimated_yob}歲`,\r\n            })\r\n          }\r\n\r\n          if (currentTerm && currentTerm.political_affiliation) {\r\n            personHighlight.push({\r\n              title: '報稱政治聯繫',\r\n              text: `${currentTerm.political_affiliation}`,\r\n            })\r\n          } else if (lastElection && lastElection.political_affiliation) {\r\n            personHighlight.push({\r\n              title: '報稱政治聯繫',\r\n              text:\r\n                `${lastElection.political_affiliation}` +\r\n                (lastElection.camp && `（${lastElection.camp}）`),\r\n            })\r\n          }\r\n\r\n          personHighlight.push({\r\n            title: '職業',\r\n            text:\r\n              (currentTerm && currentTerm.career) || lastElection.occupation,\r\n          })\r\n\r\n          console.log(person)\r\n\r\n          return (\r\n            <>\r\n              <CandidateHeaderContainer>\r\n                <Box\r\n                  width={{ sm: '250px', md: '300px' }}\r\n                  height={{ sm: '300px' }}\r\n                >\r\n                  <CandidateAvatar\r\n                    src={`${homeUrl}/static/images/avatar/${person.uuid}.jpg`}\r\n                    imgProps={{\r\n                      onError: e => {\r\n                        e.target.src = `${homeUrl}/static/images/avatar/default.png`\r\n                      },\r\n                    }}\r\n                  />\r\n                </Box>\r\n                <Box>\r\n                  <PersonName>\r\n                    <Typography\r\n                      variant=\"h3\"\r\n                      style={{ marginBottom: '2px', color: 'white' }}\r\n                    >\r\n                      {person.name_zh || ''}\r\n                    </Typography>\r\n                    <Typography\r\n                      variant=\"h5\"\r\n                      style={{ marginBottom: '8px', color: 'white' }}\r\n                    >\r\n                      {person.name_en || ''}\r\n                    </Typography>\r\n                    {currentTerm && (\r\n                      <Typography\r\n                        variant=\"h6\"\r\n                        style={{ marginBottom: '8px', color: 'black' }}\r\n                      >{`現任${currentTerm.district.dc_name_zh}區議員（${currentTerm.constituency.name_zh}）`}</Typography>\r\n                    )}\r\n                  </PersonName>\r\n                </Box>\r\n              </CandidateHeaderContainer>\r\n\r\n              <PersonHighlight>\r\n                {personHighlight.map((highlight, index) => (\r\n                  <Box key={index} p={2}>\r\n                    <Typography variant=\"h5\">{highlight.text}</Typography>\r\n                    <Typography variant=\"h6\">{highlight.title}</Typography>\r\n                  </Box>\r\n                ))}\r\n              </PersonHighlight>\r\n\r\n              <ScrollableTabsButtonAuto />\r\n              {/* <ElectionHistoryContainer>\r\n                <Grid container spacing={3}>\r\n                  <Grid item xs={12}>\r\n                    <ElectionHistoryHeader>區議會選舉</ElectionHistoryHeader>\r\n                  </Grid>\r\n\r\n                  {person.elections\r\n                    .sort((a, b) => b.year - a.year)\r\n                    .map(election =>\r\n                      this.renderElectionInfoCard(\r\n                        election,\r\n                        person.estimated_yob\r\n                      )\r\n                    )}\r\n                </Grid>\r\n              </ElectionHistoryContainer> */}\r\n            </>\r\n          )\r\n        }}\r\n      </Query>\r\n    )\r\n  }\r\n}\r\n\r\nexport default ProfilePage\r\n","import React, { Component } from 'react'\r\nimport Map from 'ol/Map'\r\nimport View from 'ol/View'\r\nimport TileLayer from 'ol/layer/Tile'\r\nimport VectorLayer from 'ol/layer/Vector'\r\nimport VectorSource from 'ol/source/Vector'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport GeoJSON from 'ol/format/GeoJSON'\r\nimport { Style, Stroke, Fill, Text } from 'ol/style'\r\nimport Select from 'ol/interaction/Select'\r\nimport styled from 'styled-components'\r\n\r\nimport dc2003 from '../data/DCCA_2003'\r\nimport dc2007 from '../data/DCCA_2007'\r\nimport dc2011 from '../data/DCCA_2011'\r\nimport dc2015 from '../data/DCCA_2015'\r\nimport dc2019 from '../data/DCCA_2019'\r\n\r\nconst MapContainer = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n`\r\n\r\nconst regionStyle = new Style({\r\n  fill: new Fill({\r\n    color: 'rgba(255, 255, 255, 0.2)',\r\n  }),\r\n  stroke: new Stroke({\r\n    color: '#319FD3',\r\n    width: 1,\r\n  }),\r\n  text: new Text({\r\n    font: '16px Calibri,sans-serif',\r\n    fill: new Fill({\r\n      color: '#000',\r\n    }),\r\n    stroke: new Stroke({\r\n      color: '#fff',\r\n      width: 2,\r\n    }),\r\n  }),\r\n})\r\n\r\nconst highlightStyle = new Style({\r\n  stroke: new Stroke({\r\n    color: '#f00',\r\n    width: 1,\r\n  }),\r\n  fill: new Fill({\r\n    color: 'rgba(255,0,0,0.1)',\r\n  }),\r\n  text: new Text({\r\n    font: '16px Calibri,sans-serif',\r\n    fill: new Fill({\r\n      color: '#000',\r\n    }),\r\n    stroke: new Stroke({\r\n      color: '#f00',\r\n      width: 2,\r\n    }),\r\n  }),\r\n})\r\n\r\nclass OLMap extends Component {\r\n  featureOverlay\r\n  highlightedFeature\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {}\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { year, code } = this.props\r\n    const dc = [dc2003, dc2007, dc2011, dc2015, dc2019].find(\r\n      d => d.name === `DCCA_${year}`\r\n    )\r\n    let isDCDataExist = dc ? true : false\r\n    let featuresLayer\r\n\r\n    if (isDCDataExist) {\r\n      this.featureSource = new VectorSource({\r\n        features: new GeoJSON().readFeatures(dc),\r\n      })\r\n\r\n      featuresLayer = new VectorLayer({\r\n        source: this.featureSource,\r\n        style: feature => {\r\n          regionStyle.getText().setText(feature.getProperties().CNAME)\r\n          return regionStyle\r\n        },\r\n      })\r\n    }\r\n\r\n    // create map object with feature layer\r\n    const layers = [\r\n      //default OSM layer\r\n      new TileLayer({\r\n        source: new XYZ({\r\n          url:\r\n            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}',\r\n        }),\r\n      }),\r\n    ]\r\n\r\n    if (isDCDataExist) {\r\n      layers.push(featuresLayer)\r\n    }\r\n\r\n    const map = new Map({\r\n      target: this.refs.mapContainer,\r\n      layers,\r\n      view: new View({\r\n        projection: 'EPSG:4326',\r\n        center: [114.2029, 22.3844],\r\n        zoom: 13,\r\n      }),\r\n    })\r\n\r\n    this.featureOverlay = new VectorLayer({\r\n      source: new VectorSource(),\r\n      map: map,\r\n      style: function(feature) {\r\n        highlightStyle.getText().setText(`${feature.getProperties().CNAME}`)\r\n        return highlightStyle\r\n      },\r\n    })\r\n\r\n    if (isDCDataExist) {\r\n      // Fit to feature\r\n      const features = this.featureSource.getFeatures()\r\n      for (let i = 0; i < features.length; i++) {\r\n        if (features[i].getProperties().CACODE === code) {\r\n          const extent = features[i].getGeometry().getExtent()\r\n          map.getView().fit(extent, {\r\n            size: map.getSize(),\r\n            padding: [10, 10, 10, 10],\r\n          })\r\n\r\n          this.highlightFeature(features[i])\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    this.setState({\r\n      map,\r\n      view: map.getView(),\r\n      featuresLayer: isDCDataExist ? featuresLayer : null,\r\n    })\r\n\r\n    const select = new Select()\r\n\r\n    if (select !== null) {\r\n      map.addInteraction(select)\r\n      select.on('select', this.handleMapClick)\r\n    }\r\n  }\r\n\r\n  highlightFeature(feature) {\r\n    if (this.highlightedFeature) {\r\n      this.featureOverlay.getSource().removeFeature(this.highlightedFeature)\r\n    }\r\n\r\n    this.featureOverlay.getSource().addFeature(feature)\r\n    this.highlightedFeature = feature\r\n  }\r\n\r\n  handleMapClick = e => {\r\n    const { year, changeDistrict } = this.props\r\n    const selectedFeature = e.target.getFeatures().item(0)\r\n\r\n    if (selectedFeature) {\r\n      this.highlightFeature(selectedFeature)\r\n      changeDistrict(year, selectedFeature.get('CACODE'))\r\n      this.state.map.getView().fit(selectedFeature.getGeometry().getExtent(), {\r\n        duration: 200,\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return <MapContainer ref=\"mapContainer\"> </MapContainer>\r\n  }\r\n}\r\n\r\nexport default OLMap\r\n","import React, { Component } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\r\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport Box from '@material-ui/core/Box'\r\nimport PropTypes from 'prop-types'\r\nimport { bps } from 'ui/responsive'\r\n\r\nconst Container = styled(Paper)`\r\n  && {\r\n    width: 400px;\r\n    height: 400px;\r\n    background-color: #f6f6f6;\r\n    padding: 0;\r\n\r\n    ${bps.down('md')} {\r\n      width: 100%;\r\n    }\r\n  }\r\n`\r\n\r\nconst InnerContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    align-items: baseline;\r\n    padding-left: 32px;\r\n    padding-right: 32px;\r\n  }\r\n`\r\n\r\nconst YearText = styled(Typography)`\r\n  && {\r\n    font-family: Avenir;\r\n    font-size: 30px;\r\n    font-weight: 900;\r\n    color: #333333;\r\n  }\r\n`\r\n\r\nconst RegionText = styled(Typography)`\r\n  && {\r\n    width: 100%;\r\n    font-family: PingFangTC-Medium;\r\n    font-size: 20px;\r\n    font-weight: 500;\r\n    color: #ffb700;\r\n  }\r\n`\r\n\r\nconst CodeText = styled(Typography)`\r\n  && {\r\n    margin-left: 10px;\r\n    font-family: PingFangTC-Light;\r\n    font-size: 40px;\r\n    font-weight: 300;\r\n    color: #9b9b9b;\r\n  }\r\n`\r\n\r\nconst StyledDivier = styled(Divider)`\r\n  && {\r\n    margin-top: 40px;\r\n    background-color: #cecece;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst SeperatedRow = styled(Box)`\r\n  && {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    width: 100%;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n  }\r\n`\r\n\r\nclass DistrictCard extends Component {\r\n  static propTypes = {\r\n    year: PropTypes.number.isRequired,\r\n    code: PropTypes.string.isRequired,\r\n    name_zh: PropTypes.string.isRequired,\r\n    name_en: PropTypes.string.isRequired,\r\n    onPrevElection: PropTypes.func.isRequired,\r\n    onNextElection: PropTypes.func.isRequired,\r\n    councilors: PropTypes.array.isRequired,\r\n    district: PropTypes.object.isRequired,\r\n  }\r\n\r\n  renderPrevElectionButton(year) {\r\n    return year > 1999 ? (\r\n      <IconButton aria-label=\"arrow_back\" onClick={this.props.onPrevElection}>\r\n        <ArrowBackIcon />\r\n      </IconButton>\r\n    ) : (\r\n      // if there is no next button, show a 48x48 empty box to align the 2 elements on the right\r\n      <div style={{ width: '48px', height: '48px' }}></div>\r\n    )\r\n  }\r\n\r\n  renderNextElectionButton(year) {\r\n    const nextElectionYear = year + 4\r\n    const currentYear = new Date().getFullYear()\r\n    return nextElectionYear <= currentYear ? (\r\n      <IconButton\r\n        aria-label=\"arrow_forward\"\r\n        onClick={this.props.onNextElection}\r\n      >\r\n        <ArrowForwardIcon />\r\n      </IconButton>\r\n    ) : (\r\n      // if there is no next button, show a 48x48 empty box to align the 2 elements on the left\r\n      <div style={{ width: '48px', height: '48px' }}></div>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { name_zh, year, code, councilors, district, stations } = this.props\r\n    const councilor = councilors.length > 0 ? councilors[0] : {}\r\n    return (\r\n      <Container>\r\n        <InnerContainer border={0} color=\"primary.minor\">\r\n          <SeperatedRow>\r\n            {this.renderPrevElectionButton(year)}\r\n            <YearText variant=\"button\" gutterBottom>\r\n              {year}\r\n            </YearText>\r\n            {this.renderNextElectionButton(year)}\r\n          </SeperatedRow>\r\n          <RegionText>{district.dc_name_zh}</RegionText>\r\n          <Typography variant=\"h3\">{name_zh}</Typography>\r\n          <CodeText>{code}</CodeText>\r\n          <StyledDivier />\r\n          <SeperatedRow>\r\n            <Typography variant=\"h6\">區議員</Typography>\r\n            <Typography>\r\n              {councilor.person ? councilor.person.name_zh : '-'}\r\n            </Typography>\r\n          </SeperatedRow>\r\n          <SeperatedRow>\r\n            <Typography variant=\"h6\">政治聯繫</Typography>\r\n            <Typography>{councilor.political_affiliation || '-'}</Typography>\r\n          </SeperatedRow>\r\n          <SeperatedRow>\r\n            <Typography variant=\"h6\">投票站</Typography>\r\n            {stations.map((station, index) => (\r\n              <Typography key={index} variant=\"subtitle2\">\r\n                {station.name_zh}\r\n              </Typography>\r\n            ))}\r\n          </SeperatedRow>\r\n        </InnerContainer>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DistrictCard\r\n","import React, { Component } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\nimport PropTypes from 'prop-types'\r\n\r\nconst Container = styled.div`\r\n   {\r\n    padding: 16px;\r\n  }\r\n`\r\n\r\nclass MainAreas extends Component {\r\n  static propTypes = {\r\n    areas: PropTypes.array.isRequired,\r\n  }\r\n\r\n  render() {\r\n    const { areas } = this.props\r\n    return (\r\n      <Container>\r\n        <Typography variant=\"h6\" gutterBottom>\r\n          主要屋邨 / 地區\r\n        </Typography>\r\n        <Box display=\"flex\" flexWrap=\"wrap\" alignContent=\"flex-start\">\r\n          {areas.map((area, index) => (\r\n            <Box mr={1} key={index}>\r\n              <Typography variant=\"body1\">\r\n                {`${Object.keys(area)[0]} ${area[Object.keys(area)[0]]}`}\r\n              </Typography>\r\n            </Box>\r\n          ))}\r\n        </Box>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n\r\nexport default MainAreas\r\n","import React from 'react'\r\nimport { lighten, makeStyles, withStyles } from '@material-ui/core/styles'\r\nimport LinearProgress from '@material-ui/core/LinearProgress'\r\n\r\nconst useStyles = makeStyles(theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  margin: {\r\n    margin: theme.spacing(1),\r\n  },\r\n}))\r\n\r\nconst BorderLinearProgress = withStyles({\r\n  root: {\r\n    height: 20,\r\n    width: 100,\r\n    backgroundColor: props => lighten(props.bgcolor, 0.5),\r\n  },\r\n  bar: {\r\n    borderRadius: 20,\r\n    backgroundColor: props => props.bgcolor,\r\n  },\r\n})(LinearProgress)\r\n\r\nexport default function CustomizedProgressBars(props) {\r\n  const classes = useStyles()\r\n  return (\r\n    <React.Fragment>\r\n      <BorderLinearProgress\r\n        className={classes.margin}\r\n        variant=\"determinate\"\r\n        color=\"secondary\"\r\n        value={props.value}\r\n        bgcolor={props.color}\r\n      />\r\n    </React.Fragment>\r\n  )\r\n}\r\n","import React, { Component } from 'react'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport styled, { css } from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\nimport PropTypes from 'prop-types'\r\nimport CustomizedProgressBars from '../../components/BorderLinearProgress'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport { bps } from 'ui/responsive'\r\n\r\nconst fontBoldStyle = css`\r\n  font-family: 'PingFangTC-Medium';\r\n  font-style: normal;\r\n  font-stretch: normal;\r\n  line-height: normal;\r\n  letter-spacing: normal;\r\n`\r\n\r\nconst fontNormalStyle = css`\r\n  font-family: 'PingFangTC';\r\n  font-style: normal;\r\n  font-stretch: normal;\r\n  line-height: normal;\r\n  letter-spacing: normal;\r\n`\r\n\r\nconst OvalButton = styled.div`\r\n  width: 95px;\r\n  height: 95px;\r\n  background: url('/static/images/electedIcon.png');\r\n`\r\n\r\nconst Container = styled.div`\r\n   {\r\n    padding: 0px 15px 100px 25px;\r\n  }\r\n`\r\n\r\nconst RowsContainer = styled.div`\r\n   {\r\n    margin-top: 30px;\r\n    border-radius: 8px;\r\n    box-shadow: 0 2px 10px 0 rgba(0, 0, 0, 0.2);\r\n    background-color: #ffffff;\r\n    ${bps.down('sm')} {\r\n      margin-left: 10px;\r\n      margin-right: 10px;\r\n    }\r\n  }\r\n`\r\n\r\nconst FlexRowContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-content: flex-start;\r\n    width: 1440px;\r\n    margin: auto;\r\n    cursor: pointer;\r\n    ${bps.down('sm')} {\r\n      width: 1440px;\r\n      margin: auto;\r\n    }\r\n  }\r\n`\r\n\r\nconst FlexColumn = styled(Box)`\r\n  && {\r\n    height: 149px;\r\n    align-items: center;\r\n    display: flex;\r\n    padding-left: 40px;\r\n    ${bps.down('sm')} {\r\n      height: 80px;\r\n    }\r\n  }\r\n`\r\n\r\nconst AvatarColumn = styled(FlexColumn)`\r\n  && {\r\n    width: 100px;\r\n    ${bps.down('sm')} {\r\n      width: 100%;\r\n      height: 149px;\r\n    }\r\n  }\r\n`\r\n\r\nconst NameColumn = styled(FlexColumn)`\r\n  && {\r\n    width: 200px;\r\n    ${bps.down('sm')} {\r\n      width: 100%;\r\n    }\r\n  }\r\n`\r\n\r\nconst PoliticalColumn = styled(FlexColumn)`\r\n  && {\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: flex-start;\r\n    width: 180px;\r\n    ${bps.down('sm')} {\r\n      width: 100%;\r\n    }\r\n  }\r\n`\r\n\r\nconst StyledDivier = styled(Divider)`\r\n  && {\r\n    margin-left: 30px;\r\n    margin-right: 30px;\r\n    ${bps.down('sm')} {\r\n      margin-top: 30px;\r\n    }\r\n  }\r\n`\r\nconst CandidateListTitle = styled.div`\r\n   {\r\n    ${fontBoldStyle}\r\n    font-size: 32px;\r\n    font-weight: 600;\r\n    color: #333333;\r\n  }\r\n`\r\n\r\nconst CandidateName = styled.div`\r\n   {\r\n    ${fontBoldStyle}\r\n    font-size: 24px;\r\n    font-weight: 500;\r\n    color: #333333;\r\n  }\r\n`\r\n\r\nconst BlueVoteContainer = styled.div`\r\n   {\r\n    ${fontBoldStyle}\r\n    font-size: 18px;\r\n    font-weight: 500;\r\n    color: #306ece;\r\n  }\r\n`\r\n\r\nconst RedVoteContainer = styled.div`\r\n   {\r\n    ${fontBoldStyle}\r\n    font-size: 18px;\r\n    font-weight: 500;\r\n    color: #f6416e;\r\n  }\r\n`\r\n\r\nconst ContentHeader = styled.div`\r\n   {\r\n    ${fontBoldStyle}\r\n    font-size: 18px;\r\n    font-weight: 600;\r\n    color: #4a4a4a;\r\n  }\r\n`\r\n\r\nconst Content = styled.div`\r\n   {\r\n    ${fontNormalStyle}\r\n    font-size: 18px;\r\n    color: #4a4a4a;\r\n  }\r\n`\r\n\r\nclass CandidateList extends Component {\r\n  static propTypes = {\r\n    candidates: PropTypes.array.isRequired,\r\n    year: PropTypes.number.isRequired,\r\n    code: PropTypes.string.isRequired,\r\n  }\r\n\r\n  // todo: use ENV_VAR\r\n  homeUrl = 'https://cswbrian.github.io/district-councils-dashboard/'\r\n\r\n  render() {\r\n    const { candidates } = this.props\r\n\r\n    return (\r\n      <Container maxWidth=\"lg\">\r\n        <CandidateListTitle>議員候選人</CandidateListTitle>\r\n        <RowsContainer>\r\n          {candidates\r\n            .sort((a, b) => a.candidate_number - b.candidate_number)\r\n            .map((candidate, index) => (\r\n              <React.Fragment key={index}>\r\n                {index > 0 ? <StyledDivier /> : null}\r\n                <FlexRowContainer\r\n                  style={{ width: '100%' }}\r\n                  key={candidate.candidate_number}\r\n                  onClick={() => {\r\n                    this.props.handleCandidateSelected(candidate.person.id)\r\n                  }}\r\n                >\r\n                  <AvatarColumn>\r\n                    <Avatar\r\n                      src={`${this.homeUrl}/static/images/avatar/${candidate.person.uuid}.jpg`}\r\n                      imgProps={{\r\n                        onError: e => {\r\n                          e.target.src =\r\n                            this.homeUrl + '/static/images/avatar/default.png'\r\n                        },\r\n                      }}\r\n                      style={{\r\n                        width: '66px',\r\n                        height: '88px',\r\n                        borderRadius: 0,\r\n                      }}\r\n                    ></Avatar>\r\n                  </AvatarColumn>\r\n                  <NameColumn p={1}>\r\n                    <CandidateName>\r\n                      {candidate.candidate_number !== 0 &&\r\n                        `${candidate.candidate_number}. `}\r\n                      {candidate.person.name_zh || candidate.person.name_en}\r\n                    </CandidateName>\r\n                  </NameColumn>\r\n                  <PoliticalColumn>\r\n                    <ContentHeader>陣營</ContentHeader>\r\n                    {'\\n'}\r\n                    <Content>{candidate.camp}</Content>\r\n                  </PoliticalColumn>\r\n                  <PoliticalColumn>\r\n                    <ContentHeader>政治聯繫</ContentHeader>\r\n                    {'\\n'}\r\n                    <Content>{candidate.political_affiliation}</Content>\r\n                  </PoliticalColumn>\r\n                  {candidate.candidate_number !== 0 && (\r\n                    <>\r\n                      <PoliticalColumn>\r\n                        {candidate.is_won && (\r\n                          <BlueVoteContainer>\r\n                            {`${candidate.votes}票 (${candidate.vote_percentage}%)`}\r\n                          </BlueVoteContainer>\r\n                        )}\r\n                        {!candidate.is_won && (\r\n                          <RedVoteContainer>\r\n                            {`${candidate.votes}票 (${candidate.vote_percentage}%)`}\r\n                          </RedVoteContainer>\r\n                        )}\r\n                      </PoliticalColumn>\r\n                      <FlexColumn>\r\n                        <ContentHeader style={{ color: '#9b9b9b' }}>\r\n                          得票率\r\n                        </ContentHeader>\r\n                        <Content>\r\n                          <CustomizedProgressBars\r\n                            value={parseFloat(candidate.vote_percentage)}\r\n                            color={candidate.is_won ? '#306ece' : '#f6416e'}\r\n                          />\r\n                        </Content>\r\n                      </FlexColumn>\r\n                    </>\r\n                  )}\r\n                  <FlexColumn>\r\n                    {candidate.is_won && <OvalButton />}\r\n                    {!candidate.is_won && (\r\n                      <div\r\n                        style={{\r\n                          width: '95px',\r\n                          height: '95px',\r\n                        }}\r\n                      ></div>\r\n                    )}\r\n                  </FlexColumn>\r\n                </FlexRowContainer>\r\n              </React.Fragment>\r\n            ))}\r\n        </RowsContainer>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n\r\nexport default CandidateList\r\n","import React, { Component } from 'react'\r\nimport zingchart from 'zingchart'\r\n\r\n// MUST define modulesdir for VoterTurnoutChart\r\n// https://www.zingchart.com/docs/api/modules/standard/#modules__modules_list\r\nzingchart.MODULESDIR = 'https://cdn.zingchart.com/modules/'\r\n\r\nconst chartJSON = chartData => {\r\n  const data = { male: [], female: [] }\r\n\r\n  Object.values(chartData.data).forEach(value => {\r\n    data['male'].push(value['male'])\r\n    data['female'].push(value['female'])\r\n  })\r\n\r\n  // TODO: replace this hacky code\r\n  const titles = Object.keys(chartData.data).map(\r\n    key =>\r\n      key\r\n        .split('_')\r\n        .filter(val => !isNaN(parseInt(val)))\r\n        .join('-') + '歲'\r\n  )\r\n  titles[titles.length - 1] += '及以上'\r\n  // Demo\r\n  // https://codepen.io/pen/?editors=1010\r\n\r\n  return {\r\n    type: 'bar',\r\n    stacked: true,\r\n    'stack-type': 'normal',\r\n    title: {\r\n      text: '投票人士年齡分布',\r\n      x: '40px',\r\n      y: '5px',\r\n      align: 'left',\r\n    },\r\n    subtitle: {\r\n      text: '佔全部',\r\n      x: '175px',\r\n      y: '5px',\r\n      align: 'left',\r\n      bold: false,\r\n      'font-size': '10px',\r\n      'font-color': '#7E7E7E',\r\n      'background-color': 'none',\r\n    },\r\n    plot: {\r\n      'bar-width': '25px',\r\n      'hover-state': {\r\n        visible: false,\r\n      },\r\n      animation: {\r\n        delay: 300,\r\n        sequence: 1,\r\n      },\r\n      valueBox: {\r\n        text: '%total',\r\n        rules: [\r\n          {\r\n            rule: '%stack-top == 0',\r\n            visible: 0,\r\n          },\r\n        ],\r\n        decimals: 0,\r\n      },\r\n    },\r\n    'scale-x': {\r\n      values: titles,\r\n      tick: {\r\n        visible: false,\r\n      },\r\n      guide: {\r\n        visible: false,\r\n      },\r\n      item: {\r\n        'font-color': '#8B8B8B',\r\n      },\r\n    },\r\n    'scale-y': {\r\n      short: true,\r\n      'line-color': '#7E7E7E',\r\n      tick: {\r\n        visible: false,\r\n      },\r\n      guide: {\r\n        'line-style': 'solid',\r\n      },\r\n      item: {\r\n        'font-color': '#8B8B8B',\r\n      },\r\n    },\r\n    series: [\r\n      {\r\n        values: data.male,\r\n        'background-color': '#003f5c',\r\n      },\r\n      {\r\n        values: data.female,\r\n        'background-color': '#ff6361',\r\n      },\r\n    ],\r\n    tooltip: {\r\n      visible: false,\r\n    },\r\n  }\r\n}\r\n\r\nclass VoterTurnoutChart extends Component {\r\n  componentDidMount() {\r\n    zingchart.render({\r\n      id: this.props.id,\r\n      // data: this.props.data,\r\n      data: chartJSON(this.props.data),\r\n    })\r\n  }\r\n\r\n  //Used to check the values being passed in to avoid unnecessary changes.\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    //Lazy object comparison\r\n    return !(JSON.stringify(nextProps.data) === JSON.stringify(this.props.data))\r\n  }\r\n\r\n  componentWillUpdate(nextProps) {\r\n    zingchart.exec(this.props.id, 'setdata', {\r\n      data: chartJSON(nextProps.data), //nextProps.data,\r\n    })\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div\r\n        id={this.props.id}\r\n        style={{\r\n          width: this.props.width || '100%',\r\n          height: this.props.height || '450px',\r\n        }}\r\n      ></div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default VoterTurnoutChart\r\n","import React, { Component } from 'react'\r\nimport * as d3 from 'd3'\r\n\r\n/**\r\n * Idea from https://gist.github.com/XavierGimenez/8070956\r\n */\r\n\r\nclass WaffleChart extends Component {\r\n  drawChart(data) {\r\n    var total = 0\r\n    var width,\r\n      height,\r\n      widthSquares = 20,\r\n      heightSquares = 20,\r\n      squareSize = 20,\r\n      squareValue = 0,\r\n      gap = 1,\r\n      theData = []\r\n    var color = d3.scaleOrdinal(d3.schemeCategory10)\r\n    //total\r\n\r\n    total = d3.sum(data, function(d) {\r\n      return d.population\r\n    })\r\n    //value of a square\r\n    squareValue = total / (widthSquares * heightSquares)\r\n    //remap data\r\n    data.forEach(function(d, i) {\r\n      d.population = +d.population\r\n      d.units = Math.round(d.population / squareValue)\r\n      d.percentage = Math.floor((d.population * 100) / total)\r\n      theData = theData.concat(\r\n        Array(d.units + 1)\r\n          .join(1)\r\n          .split('')\r\n          .map(function() {\r\n            return {\r\n              squareValue: squareValue,\r\n              units: d.units,\r\n              population: d.population,\r\n              percentage: d.percentage,\r\n              groupIndex: i,\r\n            }\r\n          })\r\n      )\r\n    })\r\n    width = squareSize * widthSquares + widthSquares * gap + 25\r\n    height = squareSize * heightSquares + heightSquares * gap + 25\r\n    d3.select('#waffle')\r\n      .append('svg')\r\n      .attr('width', width)\r\n      .attr('height', height)\r\n      .append('g')\r\n      .selectAll('div')\r\n      .data(theData)\r\n      .enter()\r\n      .append('rect')\r\n      .attr('width', squareSize)\r\n      .attr('height', squareSize)\r\n      .attr('fill', function(d) {\r\n        return color(d.groupIndex)\r\n      })\r\n      .attr('y', function(d, i) {\r\n        // const row = i % heightSquares;\r\n        // return (heightSquares * squareSize) - ((row * squareSize) + (row * gap))\r\n        const row = Math.floor(i / widthSquares)\r\n        return row * squareSize + row * gap\r\n      })\r\n      .attr('x', function(d, i) {\r\n        //group n squares for column\r\n        // const col = Math.floor(i / heightSquares);\r\n        // return (col * squareSize) + (col * gap);\r\n        const col = i % widthSquares\r\n        return col * squareSize + col * gap\r\n      })\r\n      .append('title')\r\n      .text(function(d, i) {\r\n        return (\r\n          data[d.groupIndex].name +\r\n          ' | ' +\r\n          d.population +\r\n          ' , ' +\r\n          d.percentage +\r\n          '%'\r\n        )\r\n      })\r\n    //add legend with categorical data\r\n    var legend = d3\r\n      .select('#legend')\r\n      .append('svg')\r\n      .attr('width', 300)\r\n      .attr('height', 200)\r\n      .append('g')\r\n      .selectAll('div')\r\n      .data(data)\r\n      .enter()\r\n      .append('g')\r\n      .attr('transform', function(d, i) {\r\n        return 'translate(0,' + i * 20 + ')'\r\n      })\r\n    legend\r\n      .append('rect')\r\n      .attr('width', 18)\r\n      .attr('height', 18)\r\n      .style('fill', function(d, i) {\r\n        return color(i)\r\n      })\r\n    legend\r\n      .append('text')\r\n      .attr('x', 25)\r\n      .attr('y', 13)\r\n      .text(function(d) {\r\n        return d.name\r\n      })\r\n    //add value of a unit square\r\n    var legend2 = d3\r\n      .select('#legend')\r\n      .select('svg')\r\n      .append('g')\r\n      .attr('transform', 'translate(200,0)')\r\n    legend2\r\n      .append('text')\r\n      .attr('y', '14')\r\n      .attr('font-size', '18px')\r\n      .text('Total: ' + total)\r\n      .attr('fill', '#444444')\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.drawChart(this.props.data)\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <div id=\"waffle\"></div>\r\n\r\n        <div id=\"legend\"></div>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default WaffleChart\r\n","import React, { Component } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport PropTypes from 'prop-types'\r\nimport gql from 'graphql-tag'\r\nimport { Query } from 'react-apollo'\r\nimport VoterTurnoutChart from './VoterTurnoutChart'\r\nimport WaffleChart from '../charts/WaffleChart'\r\n\r\n// TODO: change this to dcd data\r\nconst QUERY_FETCH_VOTES = gql`\r\n  query($year: Int!, $code: String!) {\r\n    dc_constituencies(where: { year: { _eq: $year }, code: { _eq: $code } }) {\r\n      candidates_aggregate {\r\n        aggregate {\r\n          sum {\r\n            votes\r\n          }\r\n        }\r\n      }\r\n      candidates {\r\n        votes\r\n        person {\r\n          name_zh\r\n          name_en\r\n        }\r\n      }\r\n      vote_stat {\r\n        total_votes\r\n        total_voters\r\n        total_voted_voters\r\n        population_excluded_foreign_worker\r\n        population_excluded_foreign_worker_lte_age_15\r\n        population_excluded_foreign_worker_lte_age_20\r\n      }\r\n      station_stats {\r\n        station_code\r\n        name_en\r\n        name_zh\r\n        votes {\r\n          votes\r\n          age\r\n          gender\r\n        }\r\n      }\r\n    }\r\n  }\r\n`\r\nconst Container = styled.div`\r\n   {\r\n    padding: 0px 15px 100px 25px;\r\n  }\r\n`\r\n\r\nconst getDataForWaffleChart = (voteStat, candidates) => {\r\n  const {\r\n    total_votes,\r\n    total_voters,\r\n    total_voted_voters,\r\n    population_excluded_foreign_worker,\r\n    population_excluded_foreign_worker_lte_age_15,\r\n    // population_excluded_foreign_worker_lte_age_20\r\n  } = voteStat\r\n\r\n  // check first the data\r\n  // TODO: the data should be good enough to remove this checking\r\n  if (\r\n    population_excluded_foreign_worker_lte_age_15 < total_voters ||\r\n    total_voters === 0 ||\r\n    total_voted_voters === 0\r\n  ) {\r\n    return []\r\n  }\r\n\r\n  const voteStats = [\r\n    {\r\n      name: '不能投票',\r\n      // population: population_excluded_foreign_worker - population_excluded_foreign_worker_lte_age_15,\r\n      population: population_excluded_foreign_worker - total_voters,\r\n    },\r\n    {\r\n      name: '沒有投票',\r\n      population:\r\n        population_excluded_foreign_worker_lte_age_15 - total_voted_voters,\r\n      // total_votes - total_voted_voters = registered but didn't vote?\r\n    },\r\n    {\r\n      name: '投票失效',\r\n      population: total_voted_voters - total_votes,\r\n      // total_votes - total_voted_voters = registered but didn't vote?\r\n    },\r\n  ]\r\n\r\n  candidates.forEach(({ votes, person: { name_zh, name_en } }) => {\r\n    voteStats.push({\r\n      name: `投給${name_zh || name_en}`,\r\n      population: votes,\r\n      // total_votes - total_voted_voters = registered but didn't vote?\r\n    })\r\n  })\r\n\r\n  return voteStats\r\n}\r\n\r\nclass MainAreas extends Component {\r\n  static propTypes = {\r\n    year: PropTypes.number.isRequired,\r\n    code: PropTypes.string.isRequired,\r\n    district: PropTypes.object.isRequired,\r\n  }\r\n\r\n  render() {\r\n    const { year, code } = this.props\r\n    return (\r\n      <Query\r\n        query={QUERY_FETCH_VOTES}\r\n        variables={{ year: parseInt(year, 10), code }}\r\n      >\r\n        {({ loading, error, data }) => {\r\n          if (loading) return null\r\n          if (error) return `Error! ${error}`\r\n          const { candidates, vote_stat } = data.dc_constituencies[0]\r\n\r\n          let voteStats = []\r\n          if (vote_stat) {\r\n            voteStats = getDataForWaffleChart(vote_stat, candidates)\r\n          }\r\n\r\n          const stats = data.dc_constituencies[0].station_stats\r\n          const barVote = { data: {} }\r\n          barVote.total = stats.reduce((acc, cur) => {\r\n            const sub_total = cur.votes.reduce((acc, cur) => {\r\n              if (typeof barVote.data[cur.age] === 'undefined') {\r\n                barVote.data[cur.age] = {}\r\n              }\r\n              if (typeof barVote.data[cur.age][cur.gender] === 'undefined') {\r\n                barVote.data[cur.age][cur.gender] = 0\r\n              }\r\n              barVote.data[cur.age][cur.gender] += cur.votes\r\n              return acc + cur.votes\r\n            }, 0)\r\n            return acc + sub_total\r\n          }, 0)\r\n          return (\r\n            <Container>\r\n              <Typography variant=\"h4\">人口資料</Typography>\r\n              <VoterTurnoutChart\r\n                id={`${year}_${code}_voter_turnout`}\r\n                data={barVote}\r\n              />\r\n              {voteStats.length > 0 ? (\r\n                <WaffleChart\r\n                  id={`${year}_${code}_voter_treemap`}\r\n                  data={voteStats}\r\n                />\r\n              ) : (\r\n                ''\r\n              )}\r\n            </Container>\r\n          )\r\n        }}\r\n      </Query>\r\n    )\r\n  }\r\n}\r\n\r\nexport default MainAreas\r\n","// TODO: split this\r\nimport gql from 'graphql-tag'\r\n\r\nconst CONSTITUENCIES_DATA = `\r\nname_zh\r\nname_en\r\ndistrict {\r\n  dc_name_en\r\n  dc_name_zh\r\n  area_name_en\r\n  area_name_zh\r\n}\r\ncode\r\ndeviation_percentage\r\nexpected_population\r\nmain_areas\r\nvote_stats {\r\n  count\r\n  type\r\n  subtype\r\n  category_1\r\n  category_2\r\n}\r\nstations {\r\n  station_code\r\n  name_en\r\n  name_zh\r\n  location\r\n}\r\ntags {\r\n  tag\r\n}\r\ncouncilors {\r\n  political_affiliation\r\n  person {\r\n    id\r\n    uuid\r\n    name_zh\r\n    name_en\r\n  }\r\n}\r\ncandidates {\r\n  candidate_number\r\n  political_affiliation\r\n  camp\r\n  person {\r\n    id\r\n    uuid\r\n    name_zh\r\n    name_en\r\n  }\r\n  vote_percentage\r\n  votes\r\n  is_won\r\n}\r\n`\r\n\r\nexport const QUERY_CONSTITUENCIES = gql`\r\nquery($year: Int!, $lastElectionYear:Int!, $code: String!) {\r\n  dcd_constituencies(where: { year: { _eq: $year }, code: { _eq: $code } }) {\r\n    ${CONSTITUENCIES_DATA}\r\n  }\r\n  last_dcd_constituencies: dcd_constituencies(where: { year: { _eq: $lastElectionYear }, code: { _eq: $code } }) {\r\n    ${CONSTITUENCIES_DATA}\r\n  }\r\n}\r\n`\r\n","import React, { Component } from 'react'\r\nimport Box from '@material-ui/core/Box'\r\nimport OLMap from '../../components/OLMap'\r\nimport { Query } from 'react-apollo'\r\nimport DistrictCard from 'components/district/DistrictCard'\r\nimport MainAreas from 'components/district/MainAreas'\r\nimport CandidateList from 'components/district/CandidateList'\r\nimport Metrics from 'components/district/Metrics'\r\nimport styled from 'styled-components'\r\nimport { bps } from 'ui/responsive'\r\n\r\nimport { QUERY_CONSTITUENCIES } from 'queries/gql'\r\n\r\nconst FullWidthBox = styled(Box)`\r\n  && {\r\n    padding-top: 4rem;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst LowerBackgroundContainer = styled(Box)`\r\n  && {\r\n    width: 100vw;\r\n    position: relative;\r\n    margin-left: -50vw;\r\n    left: 50%;\r\n    background-color: #fafafa;\r\n  }\r\n`\r\n\r\nconst FlexRowContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-content: flex-start;\r\n    ${bps.up('md')} {\r\n      width: 100%;\r\n    }\r\n\r\n    ${bps.up('lg')} {\r\n      width: 1440px;\r\n    }\r\n    margin: auto;\r\n  }\r\n`\r\n\r\nconst DistrictCardContainer = styled(Box)`\r\n  && {\r\n    padding-left: 30px;\r\n    margin: 0px;\r\n    width: 400px;\r\n    height: 400px;\r\n\r\n    ${bps.down('md')} {\r\n      margin: 10px;\r\n      width: 100%;\r\n      padding: 0px;\r\n    }\r\n  }\r\n`\r\n\r\nclass DistrictPage extends Component {\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    //  if (this.props.route.path === nextProps.route.path) return false;\r\n    return true\r\n  }\r\n\r\n  handleCandidateSelected = candidateId => {\r\n    this.props.history.push(`/profile/${candidateId}`)\r\n  }\r\n\r\n  handleChangeDistrict = (year, code) => {\r\n    if (!year || !code) return\r\n    this.props.history.push(`/district/${year}/${code}`)\r\n  }\r\n\r\n  onPrevElection() {\r\n    const {\r\n      match: {\r\n        params: { year, code },\r\n      },\r\n    } = this.props\r\n    this.props.history.push(`/district/${parseInt(year, 10) - 4}/${code}`)\r\n  }\r\n\r\n  onNextElection() {\r\n    const {\r\n      match: {\r\n        params: { year, code },\r\n      },\r\n    } = this.props\r\n    this.props.history.push(`/district/${parseInt(year, 10) + 4}/${code}`)\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      match: {\r\n        params: { year, code },\r\n      },\r\n    } = this.props\r\n\r\n    return (\r\n      <>\r\n        <FlexRowContainer>\r\n          <Box\r\n            width={{ sm: '100%', md: '960px' }}\r\n            height={{ sm: '300px', md: '400px' }}\r\n          >\r\n            <OLMap\r\n              year={year}\r\n              code={code}\r\n              changeDistrict={this.handleChangeDistrict}\r\n            />\r\n          </Box>\r\n          <Query query={QUERY_CONSTITUENCIES} variables={{ year, code }}>\r\n            {({ loading, error, data }) => {\r\n              if (loading) return null\r\n              if (error) return `Error! ${error}`\r\n              const district = data.dcd_constituencies[0]\r\n              return (\r\n                <>\r\n                  <DistrictCardContainer>\r\n                    <DistrictCard\r\n                      {...district}\r\n                      year={parseInt(year, 10)}\r\n                      code={code}\r\n                      onNextElection={this.onNextElection.bind(this)}\r\n                      onPrevElection={this.onPrevElection.bind(this)}\r\n                    />\r\n                  </DistrictCardContainer>\r\n                  <FullWidthBox>\r\n                    <MainAreas areas={district.main_areas || []} />\r\n                  </FullWidthBox>\r\n                  <LowerBackgroundContainer>\r\n                    <FlexRowContainer>\r\n                      <FullWidthBox>\r\n                        <Metrics\r\n                          year={parseInt(year, 10)}\r\n                          code={code}\r\n                          district={district}\r\n                        ></Metrics>\r\n                      </FullWidthBox>\r\n                      <FullWidthBox>\r\n                        <CandidateList\r\n                          candidates={district.candidates}\r\n                          year={parseInt(year, 10)}\r\n                          code={code}\r\n                          handleCandidateSelected={this.handleCandidateSelected}\r\n                        />\r\n                      </FullWidthBox>\r\n                    </FlexRowContainer>\r\n                  </LowerBackgroundContainer>\r\n                </>\r\n              )\r\n            }}\r\n          </Query>\r\n        </FlexRowContainer>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DistrictPage\r\n","import React, { Component } from 'react'\r\nimport Map from 'ol/Map'\r\nimport View from 'ol/View'\r\nimport TileLayer from 'ol/layer/Tile'\r\nimport VectorLayer from 'ol/layer/Vector'\r\nimport VectorSource from 'ol/source/Vector'\r\nimport XYZ from 'ol/source/XYZ'\r\nimport GeoJSON from 'ol/format/GeoJSON'\r\nimport { Style, Stroke, Fill, Text } from 'ol/style'\r\nimport Select from 'ol/interaction/Select'\r\nimport styled from 'styled-components'\r\n\r\nimport dc2003 from '../data/DCCA_2003'\r\nimport dc2007 from '../data/DCCA_2007'\r\nimport dc2011 from '../data/DCCA_2011'\r\nimport dc2015 from '../data/DCCA_2015'\r\nimport dc2019 from '../data/DCCA_2019'\r\n\r\nconst MapContainer = styled.div`\r\n  width: 100%;\r\n  height: 100%;\r\n`\r\n\r\nconst regionStyle = new Style({\r\n  fill: new Fill({\r\n    color: 'rgba(255, 255, 255, 0.2)',\r\n  }),\r\n  stroke: new Stroke({\r\n    color: '#319FD3',\r\n    width: 1,\r\n  }),\r\n  text: new Text({\r\n    font: '16px Calibri,sans-serif',\r\n    fill: new Fill({\r\n      color: '#000',\r\n    }),\r\n    stroke: new Stroke({\r\n      color: '#fff',\r\n      width: 2,\r\n    }),\r\n  }),\r\n})\r\n\r\nconst highlightStyle = new Style({\r\n  stroke: new Stroke({\r\n    color: '#f00',\r\n    width: 1,\r\n  }),\r\n  fill: new Fill({\r\n    color: 'rgba(255,0,0,0.1)',\r\n  }),\r\n  text: new Text({\r\n    font: '16px Calibri,sans-serif',\r\n    fill: new Fill({\r\n      color: '#000',\r\n    }),\r\n    stroke: new Stroke({\r\n      color: '#f00',\r\n      width: 2,\r\n    }),\r\n  }),\r\n})\r\n\r\nclass DCCACompareMap extends Component {\r\n  featureOverlay\r\n  highlightedFeature\r\n\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {}\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { year, code } = this.props\r\n    const dc = [dc2003, dc2007, dc2011, dc2015, dc2019].find(\r\n      d => d.name === `DCCA_${year}`\r\n    )\r\n    let isDCDataExist = dc ? true : false\r\n    let featuresLayer\r\n\r\n    if (isDCDataExist) {\r\n      this.featureSource = new VectorSource({\r\n        features: new GeoJSON().readFeatures(dc),\r\n      })\r\n\r\n      featuresLayer = new VectorLayer({\r\n        source: this.featureSource,\r\n        style: feature => {\r\n          regionStyle.getText().setText(feature.getProperties().CNAME)\r\n          return regionStyle\r\n        },\r\n      })\r\n    }\r\n\r\n    // create map object with feature layer\r\n    const layers = [\r\n      //default OSM layer\r\n      new TileLayer({\r\n        source: new XYZ({\r\n          url:\r\n            'https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}',\r\n        }),\r\n      }),\r\n    ]\r\n\r\n    if (isDCDataExist) {\r\n      layers.push(featuresLayer)\r\n    }\r\n\r\n    const map = new Map({\r\n      target: this.refs.mapContainer,\r\n      layers,\r\n      view: new View({\r\n        projection: 'EPSG:4326',\r\n        center: [114.2029, 22.3844],\r\n        zoom: 13,\r\n      }),\r\n    })\r\n\r\n    this.featureOverlay = new VectorLayer({\r\n      source: new VectorSource(),\r\n      map: map,\r\n      style: function(feature) {\r\n        highlightStyle.getText().setText(`${feature.getProperties().CNAME}`)\r\n        return highlightStyle\r\n      },\r\n    })\r\n\r\n    if (isDCDataExist) {\r\n      // Fit to feature\r\n      const features = this.featureSource.getFeatures()\r\n      for (let i = 0; i < features.length; i++) {\r\n        if (features[i].getProperties().CACODE === code) {\r\n          const extent = features[i].getGeometry().getExtent()\r\n          map.getView().fit(extent, {\r\n            size: map.getSize(),\r\n            padding: [10, 10, 10, 10],\r\n          })\r\n\r\n          this.highlightFeature(features[i])\r\n          break\r\n        }\r\n      }\r\n    }\r\n\r\n    this.setState({\r\n      map,\r\n      view: map.getView(),\r\n      featuresLayer: isDCDataExist ? featuresLayer : null,\r\n    })\r\n\r\n    const select = new Select()\r\n\r\n    if (select !== null) {\r\n      map.addInteraction(select)\r\n      select.on('select', this.handleMapClick)\r\n    }\r\n  }\r\n\r\n  highlightFeature(feature) {\r\n    if (this.highlightedFeature) {\r\n      this.featureOverlay.getSource().removeFeature(this.highlightedFeature)\r\n    }\r\n\r\n    this.featureOverlay.getSource().addFeature(feature)\r\n    this.highlightedFeature = feature\r\n  }\r\n\r\n  handleMapClick = e => {\r\n    const { year, changeDistrict } = this.props\r\n    const selectedFeature = e.target.getFeatures().item(0)\r\n\r\n    if (selectedFeature) {\r\n      this.highlightFeature(selectedFeature)\r\n      changeDistrict(year, selectedFeature.get('CACODE'))\r\n      this.state.map.getView().fit(selectedFeature.getGeometry().getExtent(), {\r\n        duration: 200,\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return <MapContainer ref=\"mapContainer\"> </MapContainer>\r\n  }\r\n}\r\n\r\nexport default DCCACompareMap\r\n","import styled from 'styled-components'\r\nimport Card from '@material-ui/core/Card'\r\nimport React from 'react'\r\n\r\nconst StyledCard = styled(Card)`\r\n  && {\r\n    padding: 16px;\r\n    margin: 16px;\r\n    background-color: #fafafa;\r\n  }\r\n`\r\n\r\nexport const PlainCard = props => {\r\n  return <StyledCard {...props}>{props.children}</StyledCard>\r\n}\r\n","import styled from 'styled-components'\r\nimport Chip from '@material-ui/core/Chip'\r\nimport React from 'react'\r\n\r\nconst StyledChip = styled(Chip)`\r\n  && {\r\n    color: ${props => props.color};\r\n  }\r\n`\r\n\r\nexport const Tag = props => {\r\n  return (\r\n    <StyledChip\r\n      label={props.value}\r\n      variant=\"outlined\"\r\n      color=\"secondary\"\r\n      // avatar={<Avatar>MB</Avatar>}\r\n      onClick={props.handleClick}\r\n    />\r\n  )\r\n}\r\n","import styled from 'styled-components'\r\nimport { NavLink } from 'react-router-dom'\r\nimport Link from '@material-ui/core/Link'\r\n\r\nexport const UnstyledLink = styled(Link)`\r\n  text-decoration: unset;\r\n  color: unset;\r\n  font-style: unset;\r\n  cursor: pointer;\r\n`\r\n\r\nexport const UnstyledNavLink = styled(NavLink)`\r\n  text-decoration: unset;\r\n  color: unset;\r\n  font-style: unset;\r\n  cursor: pointer;\r\n`\r\n","import React, { Component } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport Grid from '@material-ui/core/Grid'\r\nimport Box from '@material-ui/core/Box'\r\nimport PropTypes from 'prop-types'\r\nimport Avatar from '@material-ui/core/Avatar'\r\nimport { PlainCard } from '../molecules/Card'\r\nimport { Tag } from '../atoms/Tag'\r\nimport { UnstyledNavLink } from '../atoms/UnstyledLink'\r\n\r\nconst StyledAvatar = styled(Avatar)`\r\n  && {\r\n    margin: 10px;\r\n    width: 60px;\r\n    height: 60px;\r\n  }\r\n`\r\n\r\nclass Councillor extends Component {\r\n  static propTypes = {\r\n    // areas: PropTypes.array.isRequired\r\n  }\r\n\r\n  homeUrl = 'https://cswbrian.github.io/district-councils-dashboard'\r\n\r\n  render() {\r\n    const { councilor } = this.props\r\n    return (\r\n      <UnstyledNavLink to={`/profile/${councilor.person.id}`}>\r\n        <PlainCard>\r\n          <Box display=\"flex\">\r\n            <Box flexGrow={1}>\r\n              <Typography variant=\"h6\" gutterBottom>\r\n                現任區議員\r\n              </Typography>\r\n            </Box>\r\n            <Box>\r\n              <Tag value=\"自動當選\" />\r\n            </Box>\r\n          </Box>\r\n\r\n          <Grid container wrap=\"nowrap\" spacing={0}>\r\n            <Grid item>\r\n              <StyledAvatar\r\n                src={`${this.homeUrl}/static/images/avatar/${councilor.person.uuid}.jpg`}\r\n                imgProps={{\r\n                  onError: e => {\r\n                    e.target.src =\r\n                      this.homeUrl + '/static/images/avatar/default.png'\r\n                  },\r\n                }}\r\n              />\r\n            </Grid>\r\n            <Grid item xs>\r\n              <Typography variant=\"h4\" gutterBottom>\r\n                {councilor.person.name_zh}\r\n              </Typography>\r\n              <Box display=\"flex\">\r\n                <Box pr={1} alignSelf=\"flex-end\">\r\n                  <Typography variant=\"body2\">報稱政治聯繫</Typography>\r\n                </Box>\r\n                <Box>\r\n                  <Typography variant=\"body1\">\r\n                    {councilor.political_affiliation}\r\n                  </Typography>\r\n                </Box>\r\n              </Box>\r\n            </Grid>\r\n          </Grid>\r\n        </PlainCard>\r\n      </UnstyledNavLink>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Councillor\r\n","import styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Dialog from '@material-ui/core/Dialog'\r\nimport MuiDialogTitle from '@material-ui/core/DialogTitle'\r\nimport MuiDialogContent from '@material-ui/core/DialogContent'\r\nimport DialogActions from '@material-ui/core/DialogActions'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport React from 'react'\r\n\r\nconst StyledDialogTitle = styled(MuiDialogTitle)`\r\n  && {\r\n    padding: 16px;\r\n    min-width: 50%;\r\n  }\r\n`\r\nconst StyledDialogContent = styled(MuiDialogContent)`\r\n  && {\r\n    padding: 16px;\r\n    min-width: 50%;\r\n  }\r\n`\r\n\r\nconst DialogTitle = props => {\r\n  const { children, onClose } = props\r\n  return (\r\n    <StyledDialogTitle>\r\n      <Box display=\"flex\" alignItems=\"center\">\r\n        <Box flexGrow={1}>{children}</Box>\r\n        <Box>\r\n          {onClose ? (\r\n            <IconButton\r\n              aria-label=\"close\"\r\n              onClick={onClose}\r\n              style={{ padding: 0 }}\r\n            >\r\n              <CloseIcon />\r\n            </IconButton>\r\n          ) : null}\r\n        </Box>\r\n      </Box>\r\n    </StyledDialogTitle>\r\n  )\r\n}\r\n\r\nconst DialogContent = props => {\r\n  const { children } = props\r\n  return <StyledDialogContent>{children}</StyledDialogContent>\r\n}\r\n\r\nexport const PlainDialog = props => {\r\n  const { open, handleClose, title, content, actions } = props\r\n  return (\r\n    <Dialog\r\n      onClose={handleClose}\r\n      aria-labelledby=\"customized-dialog-title\"\r\n      open={open}\r\n    >\r\n      <DialogTitle id=\"customized-dialog-title\" onClose={handleClose}>\r\n        {title}\r\n      </DialogTitle>\r\n      <DialogContent>{content}</DialogContent>\r\n      <DialogActions>{actions}</DialogActions>\r\n    </Dialog>\r\n  )\r\n}\r\n","import React from 'react'\r\nimport { PlainDialog } from '../molecules/Dialog'\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport { PlainCard } from '../molecules/Card'\r\nimport AddIcon from '@material-ui/icons/Add'\r\n\r\nexport default function CustomizedDialogs() {\r\n  const [open, setOpen] = React.useState(false)\r\n\r\n  const handleClickOpen = () => {\r\n    setOpen(true)\r\n  }\r\n  const handleClose = () => {\r\n    setOpen(false)\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <PlainCard onClick={handleClickOpen}>\r\n        <Box display=\"flex\">\r\n          <Box flexGrow={1}>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n              現任區議員\r\n            </Typography>\r\n\r\n            <Typography variant=\"h6\">\r\n              此為新增選區，按址選擇現任區議員\r\n            </Typography>\r\n          </Box>\r\n          <Box>\r\n            <AddIcon style={{ fontSize: 48 }} />\r\n          </Box>\r\n        </Box>\r\n      </PlainCard>\r\n      <PlainDialog\r\n        open={open}\r\n        handleClose={handleClose}\r\n        title=\"此選區於2019年設立\"\r\n        content=\"content\"\r\n        actions=\"actions\"\r\n      ></PlainDialog>\r\n    </>\r\n  )\r\n}\r\n","import React, { Component } from 'react'\r\nimport styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\r\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward'\r\nimport { Tag } from '../atoms/Tag'\r\n\r\nconst Container = styled(Paper)`\r\n  && {\r\n    width: 100%;\r\n    padding: 16px;\r\n    box-shadow: none;\r\n  }\r\n`\r\n\r\nclass DCCAOverview extends Component {\r\n  static propTypes = {\r\n    // year: PropTypes.number.isRequired,\r\n    // code: PropTypes.string.isRequired,\r\n    // name_zh: PropTypes.string.isRequired,\r\n    // name_en: PropTypes.string.isRequired,\r\n    // onPrevElection: PropTypes.func.isRequired,\r\n    // onNextElection: PropTypes.func.isRequired,\r\n    // candidates: PropTypes.array.isRequired,\r\n  }\r\n\r\n  renderPrevElectionButton(year) {\r\n    return year > 1999 ? (\r\n      <IconButton aria-label=\"arrow_back\" onClick={this.props.onPrevElection}>\r\n        <ArrowBackIcon />\r\n      </IconButton>\r\n    ) : (\r\n      // if there is no next button, show a 48x48 empty box to align the 2 elements on the right\r\n      <div style={{ width: '48px', height: '48px' }}></div>\r\n    )\r\n  }\r\n\r\n  renderNextElectionButton(year) {\r\n    const nextElectionYear = year + 4\r\n    const currentYear = new Date().getFullYear()\r\n    return nextElectionYear <= currentYear ? (\r\n      <IconButton\r\n        aria-label=\"arrow_forward\"\r\n        onClick={this.props.onNextElection}\r\n      >\r\n        <ArrowForwardIcon />\r\n      </IconButton>\r\n    ) : (\r\n      // if there is no next button, show a 48x48 empty box to align the 2 elements on the left\r\n      <div style={{ width: '48px', height: '48px' }}></div>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { name_zh, year, code, dc_name_zh, tags, voterData } = this.props\r\n\r\n    const new_voters_percentage = (\r\n      (100 * voterData.aggregations.new_voters) /\r\n      voterData.aggregations.all_voters\r\n    ).toFixed(2)\r\n    return (\r\n      <Container>\r\n        <Box display=\"flex\">\r\n          <Box flexGrow={1}>\r\n            <Typography variant=\"h6\" gutterBottom>\r\n              {year} {dc_name_zh}\r\n            </Typography>\r\n          </Box>\r\n          <Box>\r\n            {tags.map((tag, index) => (\r\n              <Tag key={index} value={tag.tag} />\r\n            ))}\r\n          </Box>\r\n        </Box>\r\n        <Typography variant=\"h3\" style={{ display: 'inline-block' }}>\r\n          {name_zh}\r\n        </Typography>\r\n        <Typography\r\n          variant=\"h5\"\r\n          style={{ display: 'inline-block', marginLeft: '8px' }}\r\n        >\r\n          {code}\r\n        </Typography>\r\n        <Typography variant=\"h6\">\r\n          選民人數 {voterData.aggregations.all_voters}{' '}\r\n          {`(${\r\n            new_voters_percentage > 0 ? '+' : '-'\r\n          }${new_voters_percentage}%)`}\r\n        </Typography>\r\n      </Container>\r\n    )\r\n  }\r\n}\r\n\r\nexport default DCCAOverview\r\n","import React, { Component } from 'react'\r\nimport Box from '@material-ui/core/Box'\r\nimport DCCACompareMap from '../../components/DCCACompareMap'\r\nimport { Query } from 'react-apollo'\r\nimport MainAreas from 'components/district/MainAreas'\r\nimport Councillor from 'components/district/Councillor'\r\nimport CouncillorSelection from 'components/district/CouncillorSelection'\r\nimport CandidateList from 'components/district/CandidateList'\r\nimport DCCAOverview from 'components/district/DCCAOverview'\r\nimport styled from 'styled-components'\r\nimport { bps } from 'ui/responsive'\r\nimport Button from '@material-ui/core/Button'\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\r\nimport Collapse from '@material-ui/core/Collapse'\r\nimport _ from 'lodash'\r\nimport { QUERY_CONSTITUENCIES } from 'queries/gql'\r\n\r\nconst FullWidthBox = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst LowerBackgroundContainer = styled(Box)`\r\n  && {\r\n    width: 100vw;\r\n    position: relative;\r\n    margin-left: -50vw;\r\n    left: 50%;\r\n    background-color: #fafafa;\r\n  }\r\n`\r\n\r\nconst FlexRowContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    align-content: flex-start;\r\n    ${bps.up('md')} {\r\n      width: 100%;\r\n    }\r\n\r\n    ${bps.up('lg')} {\r\n      width: 1440px;\r\n    }\r\n    margin: auto;\r\n  }\r\n`\r\nconst groupVoteStat = voteStats => {\r\n  const data = _.groupBy(voteStats, stat => stat.subtype)\r\n  data.aggregations = {\r\n    all_voters: data.VOTERS.map(v => v.count).reduce((c, v) => c + v, 0),\r\n    new_voters: data.NEW_VOTERS.map(v => v.count).reduce((c, v) => c + v, 0),\r\n  }\r\n  return data\r\n}\r\nclass BattleGroundPage extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {\r\n      showMap: false,\r\n    }\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    //  if (this.props.route.path === nextProps.route.path) return false;\r\n    return true\r\n  }\r\n\r\n  handleCandidateSelected = candidateId => {\r\n    this.props.history.push(`/profile/${candidateId}`)\r\n  }\r\n\r\n  handleChangeDistrict = (year, code) => {\r\n    if (!year || !code) return\r\n    this.props.history.push(`/district/${year}/${code}`)\r\n  }\r\n\r\n  onPrevElection() {\r\n    const {\r\n      match: {\r\n        params: { code },\r\n      },\r\n    } = this.props\r\n    this.props.history.push(`/district/2015/${code}`)\r\n  }\r\n\r\n  onNextElection() {\r\n    const {\r\n      match: {\r\n        params: { year, code },\r\n      },\r\n    } = this.props\r\n    this.props.history.push(`/district/${parseInt(year, 10) + 4}/${code}`)\r\n  }\r\n\r\n  render() {\r\n    const { showMap } = this.state\r\n    const {\r\n      match: {\r\n        params: { year = 2019, code },\r\n      },\r\n    } = this.props\r\n\r\n    return (\r\n      <>\r\n        <Query\r\n          query={QUERY_CONSTITUENCIES}\r\n          variables={{ year, lastElectionYear: year - 4, code }}\r\n        >\r\n          {({ loading, error, data }) => {\r\n            if (loading) return null\r\n            if (error) return `Error! ${error}`\r\n            const district = data.dcd_constituencies[0]\r\n            const last_district = data.last_dcd_constituencies[0]\r\n\r\n            console.log(data)\r\n\r\n            return (\r\n              <>\r\n                <DCCAOverview\r\n                  year={year}\r\n                  name_zh={district.name_zh}\r\n                  dc_name_zh={district.district.dc_name_zh}\r\n                  code={district.code}\r\n                  tags={district.tags}\r\n                  voterData={groupVoteStat(district.vote_stats)}\r\n                />\r\n                <Button onClick={() => this.setState({ showMap: !showMap })}>\r\n                  {showMap ? '隱藏地圖' : '顯示地圖'}\r\n                  <ExpandMoreIcon />\r\n                </Button>\r\n                <Collapse in={showMap}>\r\n                  <Box\r\n                    width={{ sm: '100%', md: '960px' }}\r\n                    height={{ sm: '300px', md: '400px' }}\r\n                  >\r\n                    <DCCACompareMap\r\n                      year={year}\r\n                      code={code}\r\n                      changeDistrict={this.handleChangeDistrict}\r\n                    />\r\n                  </Box>\r\n                </Collapse>\r\n                <MainAreas areas={district.main_areas || []} />\r\n                {last_district.councilors &&\r\n                last_district.councilors.length === 1 ? (\r\n                  <Councillor councilor={last_district.councilors[0]} />\r\n                ) : (\r\n                  <CouncillorSelection />\r\n                )}\r\n                {/* <LowerBackgroundContainer>\r\n                      <FullWidthBox>\r\n                        <CandidateList\r\n                          candidates={district.candidates}\r\n                          year={parseInt(year, 10)}\r\n                          code={code}\r\n                          handleCandidateSelected={this.handleCandidateSelected}\r\n                        />\r\n                      </FullWidthBox>\r\n                  </LowerBackgroundContainer> */}\r\n              </>\r\n            )\r\n          }}\r\n        </Query>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default BattleGroundPage\r\n","import { createMuiTheme } from '@material-ui/core/styles'\r\n\r\nexport const headingFontFamily = 'PingFangTC-Medium, sans-serif'\r\nexport const bodyFontFamily = 'PT Serif, sans-serif'\r\n\r\nexport const fontFamily = [\r\n  'PingFangTC',\r\n  'Noto Sans TC',\r\n  'sans-serif',\r\n  '-apple-system',\r\n  '\"Helvetica Neue\"',\r\n  'Arial',\r\n]\r\n\r\nexport const typography = {\r\n  useNextVariants: true,\r\n  fontSize: 16,\r\n  fontFamily: fontFamily.join(','),\r\n  h1: {\r\n    fontFamily: headingFontFamily,\r\n  },\r\n  h2: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 50,\r\n    fontWeight: 500,\r\n  },\r\n  h3: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 40,\r\n    fontWeight: 500,\r\n  },\r\n  h4: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 30,\r\n    fontWeight: 500,\r\n  },\r\n  h5: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 24,\r\n    fontWeight: 500,\r\n  },\r\n  h6: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 18,\r\n    fontWeight: 500,\r\n  },\r\n  body1: {\r\n    fontFamily: bodyFontFamily,\r\n  },\r\n}\r\n\r\nexport default createMuiTheme({\r\n  typography,\r\n  palette: {\r\n    primary: {\r\n      light: '#ffffff',\r\n      main: '#000000',\r\n      dark: '#cccccc',\r\n    },\r\n    secondary: {\r\n      light: '#2c2c2c',\r\n      main: '#000000',\r\n      dark: '#000000',\r\n    },\r\n    background: {\r\n      default: '#ffffff',\r\n    },\r\n    button: {\r\n      primary: '#ffd731',\r\n      secondary: '#ffd731',\r\n    },\r\n  },\r\n})\r\n","import React, { Component } from 'react'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport createMuiTheme from '../../ui/theme'\r\nimport MuiThemeProvider from '@material-ui/core/styles/MuiThemeProvider'\r\n\r\nconst theme = createMuiTheme\r\n\r\nconst styles = theme => ({\r\n  content: {},\r\n})\r\n\r\nclass NotFoundPage extends Component {\r\n  constructor(props) {\r\n    super(props)\r\n    this.state = {}\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <MuiThemeProvider theme={theme}>\r\n        TODO - <a href=\"https://notfound.collaction.hk/\">404</a>\r\n      </MuiThemeProvider>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withStyles(styles, { withTheme: true })(NotFoundPage)\r\n","import { createMuiTheme } from '@material-ui/core/styles'\r\n\r\nexport const headingFontFamily = 'Noto Sans TC, sans-serif'\r\nexport const bodyFontFamily = 'Noto Sans TC, sans-serif'\r\n\r\nexport const fontFamily = [\r\n  'Noto Sans TC',\r\n  'sans-serif',\r\n  '-apple-system',\r\n  '\"Helvetica Neue\"',\r\n  'Arial',\r\n]\r\n\r\nexport const typography = {\r\n  useNextVariants: true,\r\n  fontSize: 16,\r\n  fontFamily: fontFamily.join(','),\r\n  h1: {\r\n    fontFamily: headingFontFamily,\r\n  },\r\n  h2: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 24,\r\n    fontWeight: 500,\r\n  },\r\n  h3: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 22,\r\n    fontWeight: 500,\r\n  },\r\n  h4: {\r\n    fontFamily: fontFamily,\r\n    fontSize: 18,\r\n    fontWeight: 500,\r\n  },\r\n  h5: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 16,\r\n    fontWeight: 500,\r\n  },\r\n  h6: {\r\n    fontFamily: headingFontFamily,\r\n    fontSize: 14,\r\n    fontWeight: 500,\r\n  },\r\n  body1: {\r\n    fontFamily: bodyFontFamily,\r\n    fontSize: 14,\r\n  },\r\n  body2: {\r\n    fontFamily: bodyFontFamily,\r\n    fontSize: 12,\r\n  },\r\n}\r\n\r\nexport default createMuiTheme({\r\n  typography,\r\n  palette: {\r\n    primary: {\r\n      main: '#fff',\r\n      contrastText: '#000',\r\n    },\r\n    secondary: {\r\n      main: '#3e474f',\r\n      contrastText: '#fff',\r\n    },\r\n    button: {\r\n      primary: '#ffd731',\r\n      secondary: '#ffd731',\r\n    },\r\n  },\r\n})\r\n\r\nexport const styledComponentTheme = {\r\n  main: {\r\n    backgroundColor: 'white',\r\n    color: 'black',\r\n  },\r\n  dark: {\r\n    backgroundColor: '#3e474f',\r\n    color: 'white',\r\n  },\r\n  secondaryBackgroundColor: '#f2f2f3', // grey\r\n  subtextColor: '#ffb500', // organe\r\n}\r\n","import * as turf from '@turf/turf'\r\n\r\nimport dc2003 from '../data/DCCA_2003'\r\nimport dc2007 from '../data/DCCA_2007'\r\nimport dc2011 from '../data/DCCA_2011'\r\nimport dc2015 from '../data/DCCA_2015'\r\nimport dc2019 from '../data/DCCA_2019'\r\n\r\nexport const getAllFeaturesFromPoint = (\r\n  point,\r\n  featuresArray = [dc2003, dc2007, dc2011, dc2015, dc2019]\r\n) => {\r\n  const pt = turf.point([point.lng, point.lat])\r\n  const result = featuresArray.map(feature => {\r\n    let polygonProps = {}\r\n    for (let i = 0, n = feature.features.length; i < n; i++) {\r\n      const poly = turf.multiPolygon(feature.features[i].geometry.coordinates)\r\n      if (turf.booleanPointInPolygon(pt, poly)) {\r\n        polygonProps = { ...feature.features[i].properties }\r\n        break\r\n      }\r\n    }\r\n    return {\r\n      year: feature.name.split('_')[1],\r\n      ...polygonProps,\r\n    }\r\n  })\r\n  return result\r\n}\r\n","import React from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport Autosuggest from 'react-autosuggest'\r\nimport match from 'autosuggest-highlight/match'\r\nimport parse from 'autosuggest-highlight/parse'\r\nimport TextField from '@material-ui/core/TextField'\r\nimport Paper from '@material-ui/core/Paper'\r\nimport MenuItem from '@material-ui/core/MenuItem'\r\nimport { withStyles } from '@material-ui/core/styles'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport SearchIcon from '@material-ui/icons/Search'\r\nimport InputAdornment from '@material-ui/core/InputAdornment'\r\nimport * as AddressParser from 'hk-address-parser-lib'\r\nimport { getAllFeaturesFromPoint } from '../utils/features'\r\n\r\nfunction renderInputComponent(inputProps) {\r\n  const { classes, inputRef = () => {}, ref, ...other } = inputProps\r\n\r\n  return (\r\n    <>\r\n      <TextField\r\n        fullWidth\r\n        InputProps={{\r\n          inputRef: node => {\r\n            ref(node)\r\n            inputRef(node)\r\n          },\r\n          classes: {\r\n            input: classes.input,\r\n          },\r\n          disableUnderline: true,\r\n          endAdornment: (\r\n            <InputAdornment position=\"end\">\r\n              <IconButton className={classes.searchButton} aria-label=\"Search\">\r\n                <SearchIcon />\r\n              </IconButton>\r\n            </InputAdornment>\r\n          ),\r\n        }}\r\n        {...other}\r\n      />\r\n    </>\r\n  )\r\n}\r\n\r\nfunction renderSuggestion(suggestion, { query, isHighlighted }) {\r\n  const matches = match(suggestion.label, query)\r\n  const parts = parse(suggestion.label, matches)\r\n\r\n  return (\r\n    <MenuItem selected={isHighlighted} component=\"div\">\r\n      {parts.map((part, index) =>\r\n        part.highlight ? (\r\n          <span key={String(index)} style={{ fontWeight: 500 }}>\r\n            {part.text}\r\n          </span>\r\n        ) : (\r\n          <strong key={String(index)} style={{ fontWeight: 300 }}>\r\n            {part.text}\r\n          </strong>\r\n        )\r\n      )}\r\n    </MenuItem>\r\n  )\r\n}\r\n\r\nfunction getSuggestionValue(suggestion) {\r\n  return suggestion.label\r\n}\r\n\r\nconst styles = theme => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  container: {\r\n    position: 'relative',\r\n  },\r\n  suggestionsContainerOpen: {\r\n    position: 'absolute',\r\n    zIndex: 1,\r\n    marginTop: theme.spacing(1),\r\n    // left: 0,\r\n    // right: 0,\r\n  },\r\n  suggestion: {\r\n    display: 'block',\r\n  },\r\n  suggestionsList: {\r\n    margin: 0,\r\n    padding: 0,\r\n    listStyleType: 'none',\r\n  },\r\n  suggestInput: {\r\n    height: '60px',\r\n    borderRadius: '4px',\r\n    boxShadow: '0 2px 16px 0 rgba(0, 0, 0, 0.1)',\r\n    backgroundColor: '#ffffff',\r\n    padding: '10px 20px',\r\n  },\r\n  input: {\r\n    textDecoration: 'none',\r\n  },\r\n  searchButton: {\r\n    color: '#ffd731',\r\n  },\r\n})\r\n\r\nclass IntegrationAutosuggest extends React.Component {\r\n  state = {\r\n    value: '',\r\n    suggestions: [],\r\n  }\r\n\r\n  async getSuggestions(value) {\r\n    const inputValue = value.trim().toLowerCase()\r\n    const inputLength = inputValue.length\r\n\r\n    if (inputLength > 0) {\r\n      const records = await AddressParser.parse(inputValue)\r\n      const result = records\r\n        .filter((_, index) => index < 10)\r\n        .map(record => ({\r\n          coordinate: record.coordinate(),\r\n          label: record.fullAddress(AddressParser.Address.LANG_ZH),\r\n        }))\r\n\r\n      return result\r\n    }\r\n\r\n    return []\r\n  }\r\n\r\n  handleSuggestionsFetchRequested = ({ value }) => {\r\n    this.getSuggestions(value).then(result => {\r\n      this.setState({\r\n        suggestions: result,\r\n      })\r\n    })\r\n  }\r\n\r\n  handleSuggestionsClearRequested = () => {\r\n    this.setState({\r\n      suggestions: [],\r\n    })\r\n  }\r\n\r\n  handleChange = name => (event, { newValue }) => {\r\n    this.setState({\r\n      [name]: newValue,\r\n    })\r\n  }\r\n\r\n  handleSuggestionSelected = (\r\n    event,\r\n    { suggestion, suggestionValue, suggestionIndex, sectionIndex, method }\r\n  ) => {\r\n    this.props.handleAddressSelected(\r\n      getAllFeaturesFromPoint(suggestion.coordinate)\r\n    )\r\n  }\r\n\r\n  render() {\r\n    const { classes } = this.props\r\n\r\n    const autosuggestProps = {\r\n      renderInputComponent,\r\n      suggestions: this.state.suggestions,\r\n      onSuggestionsFetchRequested: this.handleSuggestionsFetchRequested,\r\n      onSuggestionsClearRequested: this.handleSuggestionsClearRequested,\r\n      onSuggestionSelected: this.handleSuggestionSelected,\r\n      getSuggestionValue,\r\n      renderSuggestion,\r\n    }\r\n\r\n    return (\r\n      <div className={classes.root}>\r\n        <Autosuggest\r\n          {...autosuggestProps}\r\n          inputProps={{\r\n            classes,\r\n            placeholder: '尋找選區...',\r\n            value: this.state.value,\r\n            onChange: this.handleChange('value'),\r\n            inputRef: node => {\r\n              this.popperNode = node\r\n            },\r\n            InputLabelProps: {\r\n              shrink: true,\r\n            },\r\n          }}\r\n          theme={{\r\n            suggestionsList: classes.suggestionsList,\r\n            suggestion: classes.suggestion,\r\n            input: classes.suggestInput,\r\n          }}\r\n          renderSuggestionsContainer={options => (\r\n            <Paper\r\n              square\r\n              {...options.containerProps}\r\n              style={{\r\n                width: '100%',\r\n              }}\r\n            >\r\n              {options.children}\r\n            </Paper>\r\n          )}\r\n        />\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nIntegrationAutosuggest.propTypes = {\r\n  classes: PropTypes.object.isRequired,\r\n}\r\n\r\nexport default withStyles(styles)(IntegrationAutosuggest)\r\n","export const DRAWER_OPEN = 'drawer_open'\r\nexport const DRAWER_CLOSE = 'drawer_close'\r\n\r\nexport default (state, action) => {\r\n  switch (action.type) {\r\n    case DRAWER_OPEN:\r\n      return { open: true }\r\n    default:\r\n      return { open: false }\r\n  }\r\n}\r\n","import React from 'react'\r\nimport drawerReducer from 'reducers/drawer'\r\n\r\nexport const drawerInitialState = {\r\n  open: false,\r\n}\r\n\r\nconst ContextStore = React.createContext({\r\n  drawer: drawerInitialState,\r\n})\r\n\r\nexport const ContextStoreProvider = props => {\r\n  const [drawerState, drawerDispatch] = React.useReducer(\r\n    drawerReducer,\r\n    drawerInitialState\r\n  )\r\n\r\n  return (\r\n    <ContextStore.Provider\r\n      value={{\r\n        drawer: {\r\n          state: drawerState,\r\n          dispatch: drawerDispatch,\r\n        },\r\n      }}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport default ContextStore\r\n","import React, { useState } from 'react'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\nimport area from '../../data/area'\r\nimport district from '../../data/district'\r\nimport Button from '@material-ui/core/Button'\r\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel'\r\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary'\r\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails'\r\nimport { DRAWER_CLOSE } from 'reducers/drawer'\r\nimport ContextStore from 'ContextStore'\r\nimport { withRouter } from 'react-router-dom'\r\n\r\nconst Container = styled.div`\r\n  && {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n`\r\n\r\nconst SideBar = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-direction: row;\r\n    flex-wrap: wrap;\r\n    min-width: 200px;\r\n    max-width: 200px;\r\n  }\r\n`\r\n\r\nconst DistrictContainer = styled(Button)`\r\n  && {\r\n    width: 120px;\r\n    justify-content: left;\r\n  }\r\n`\r\n\r\nconst DistrictSelector = props => {\r\n  const {\r\n    drawer: { dispatch },\r\n  } = React.useContext(ContextStore)\r\n  const renderDCCA = code => {\r\n    if (!code) return null\r\n    return (\r\n      <div>\r\n        {Object.keys(district['2019'][code]).map(dcca => {\r\n          return (\r\n            <DistrictContainer\r\n              key={district['2019'][code][dcca].code}\r\n              onClick={() => {\r\n                dispatch({ type: DRAWER_CLOSE })\r\n                props.history.push(`/district/2019/${dcca}`)\r\n              }}\r\n              color=\"secondary\"\r\n            >\r\n              <Typography variant=\"h6\">\r\n                {district['2019'][code][dcca].name}\r\n              </Typography>\r\n            </DistrictContainer>\r\n          )\r\n        })}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      {area.map(a => (\r\n        <ExpansionPanel key={a.dccode}>\r\n          <ExpansionPanelSummary\r\n            aria-controls=\"panel1a-content\"\r\n            id=\"panel1a-header\"\r\n          >\r\n            <Typography>{a.dname_chi}</Typography>\r\n          </ExpansionPanelSummary>\r\n          <ExpansionPanelDetails>{renderDCCA(a.dccode)}</ExpansionPanelDetails>\r\n        </ExpansionPanel>\r\n      ))}\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default withRouter(DistrictSelector)\r\n","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport Box from '@material-ui/core/Box'\r\nimport AddressSearcher from '../../components/AddressSearcher'\r\nimport DistrictSelector from 'components/search/DistrictSelector'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport CloseIcon from '@material-ui/icons/Close'\r\nimport Button from '@material-ui/core/Button'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Divider from '@material-ui/core/Divider'\r\nimport { withRouter } from 'react-router-dom'\r\nimport ContextStore from 'ContextStore'\r\nimport { DRAWER_CLOSE } from 'reducers/drawer'\r\n\r\nconst StyledDivier = styled(Divider)`\r\n  && {\r\n    background-color: #ececec;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst Container = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst ExpandedRow = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n    display: flex;\r\n    justify-content: space-between;\r\n    flex-grow: 1;\r\n  }\r\n`\r\n\r\nconst ContentRowContainer = styled(ExpandedRow)`\r\n  && {\r\n    flex-flow: column;\r\n  }\r\n`\r\n\r\nconst ContentContainer = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n    justify-content: center;\r\n  }\r\n`\r\n\r\nconst AddressSearchContainer = styled(Box)`\r\n  && {\r\n    width: 100%;\r\n    padding: 21px 16px 21px 16px;\r\n    background-color: ${props => props.theme.secondaryBackgroundColor};\r\n  }\r\n`\r\n\r\nconst TabContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    width: 100%;\r\n    justify-content: center;\r\n  }\r\n`\r\n\r\nconst TabButton = styled(Button)`\r\n  && {\r\n    margin: 10px 10px 0px 10px;\r\n    padding-bottom: 15px;\r\n\r\n    color: ${props =>\r\n      props.active === 'active'\r\n        ? props.theme.subtextColor\r\n        : props.theme.main.color};\r\n    border-bottom: ${props =>\r\n      props.active === 'active'\r\n        ? `1px solid ${props.theme.subtextColor}`\r\n        : 'none'};\r\n  }\r\n`\r\n\r\nconst NavBarButton = styled(IconButton)`\r\n  && {\r\n    position: fixed;\r\n    top: 0px;\r\n    right: 0px;\r\n  }\r\n`\r\n\r\nfunction SearchDrawer(props) {\r\n  const {\r\n    drawer: { dispatch },\r\n  } = React.useContext(ContextStore)\r\n  const [selectedTab, setSelectedTab] = React.useState(\r\n    props.selectedTab || 'district'\r\n  )\r\n\r\n  // async function onAddressFieldChanged(evt) {\r\n  //   const { value } = evt.target\r\n  //   const records = await AddressParser.parse(value)\r\n  //   this.setState({\r\n  //     autoCompleteList: records,\r\n  //   })\r\n  // }\r\n\r\n  // function handlePeopleSelected(result) {\r\n  //   props.history.push(`profile/${result.id}`)\r\n  // }\r\n\r\n  function handleAddressSelected(result) {\r\n    if (!result) return\r\n\r\n    const lastest = result.pop()\r\n\r\n    /* TODO: \r\n      Use context (?) to store the Global district result array\r\n      When user select click previous button in district page, \r\n      the CACODE should follow follow the above result\r\n    */\r\n\r\n    props.history.push(`/district/${lastest.year}/${lastest.CACODE}`)\r\n\r\n    props.onDrawerClose()\r\n  }\r\n\r\n  function onTabSelected(tab) {\r\n    return () => {\r\n      setSelectedTab(tab)\r\n    }\r\n  }\r\n\r\n  function renderSearchDistrict() {\r\n    return (\r\n      <ContentRowContainer>\r\n        <AddressSearchContainer>\r\n          <AddressSearcher handleAddressSelected={handleAddressSelected} />\r\n        </AddressSearchContainer>\r\n        <DistrictSelector />\r\n      </ContentRowContainer>\r\n    )\r\n  }\r\n\r\n  function renderSearchPeople() {\r\n    return (\r\n      <ContentRowContainer>\r\n        <AddressSearchContainer>\r\n          <AddressSearcher handleAddressSelected={handleAddressSelected} />\r\n        </AddressSearchContainer>\r\n        <ContentContainer>\r\n          <DistrictSelector />\r\n        </ContentContainer>\r\n      </ContentRowContainer>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <NavBarButton\r\n        color=\"inherit\"\r\n        component=\"span\"\r\n        aria-label=\"Menu\"\r\n        onClick={() => {\r\n          dispatch({ type: DRAWER_CLOSE })\r\n        }}\r\n      >\r\n        <CloseIcon fontSize=\"small\" />\r\n      </NavBarButton>\r\n      <TabContainer>\r\n        <TabButton\r\n          active={selectedTab === 'district' ? 'active' : 'inactive'}\r\n          onClick={onTabSelected('district')}\r\n        >\r\n          <Typography variant=\"h3\">找選區</Typography>\r\n        </TabButton>\r\n        <TabButton\r\n          active={selectedTab === 'people' ? 'active' : 'inactive'}\r\n          onClick={onTabSelected('people')}\r\n        >\r\n          <Typography variant=\"h3\">找候選人</Typography>\r\n        </TabButton>\r\n      </TabContainer>\r\n      <StyledDivier />\r\n      {selectedTab === 'district'\r\n        ? renderSearchDistrict()\r\n        : renderSearchPeople()}\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default withRouter(SearchDrawer)\r\n","import React from 'react'\r\nimport AppBar from '@material-ui/core/AppBar'\r\nimport Toolbar from '@material-ui/core/Toolbar'\r\nimport IconButton from '@material-ui/core/IconButton'\r\nimport MenuIcon from '@material-ui/icons/Menu'\r\nimport SearchIcon from '@material-ui/icons/Search'\r\nimport styled from 'styled-components'\r\nimport Typography from '@material-ui/core/Typography'\r\nimport Slide from '@material-ui/core/Slide'\r\nimport { DRAWER_OPEN } from '../../reducers/drawer'\r\nimport ContextStore from 'ContextStore'\r\n\r\nconst StyledAppBar = styled(AppBar)`\r\n  && {\r\n    width: 100%;\r\n    box-shadow: none;\r\n  }\r\n`\r\n\r\nconst StyledToolbar = styled(Toolbar)`\r\n  && {\r\n    display: flex;\r\n  }\r\n`\r\n\r\nconst AppBarTitle = styled(Typography)`\r\n  && {\r\n    flex-grow: 1;\r\n    text-decoration: none;\r\n    text-align: center;\r\n  }\r\n`\r\n\r\nconst Transition = React.forwardRef((props, ref) => (\r\n  <Slide direction=\"left\" ref={ref} {...props} />\r\n))\r\nTransition.displayName = 'Transition'\r\n\r\nfunction MobileAppBar(props) {\r\n  const {\r\n    drawer: { dispatch },\r\n  } = React.useContext(ContextStore)\r\n\r\n  return (\r\n    <>\r\n      <StyledAppBar position=\"sticky\" color=\"primary\">\r\n        <StyledToolbar disableGutters>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            component=\"span\"\r\n            aria-label=\"Search\"\r\n            onClick={() => dispatch({ type: DRAWER_OPEN })}\r\n          >\r\n            <SearchIcon />\r\n          </IconButton>\r\n          <AppBarTitle variant=\"h3\">✋🧡⚡</AppBarTitle>\r\n          <IconButton\r\n            color=\"inherit\"\r\n            component=\"span\"\r\n            aria-label=\"Menu\"\r\n            onClick={() => dispatch({ type: DRAWER_OPEN })}\r\n          >\r\n            <MenuIcon />\r\n          </IconButton>\r\n        </StyledToolbar>\r\n      </StyledAppBar>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MobileAppBar\r\n","import React, { useReducer } from 'react'\r\nimport { Route, Switch } from 'react-router-dom'\r\nimport CssBaseline from '@material-ui/core/CssBaseline'\r\nimport MuiThemeProvider from '@material-ui/core/styles/MuiThemeProvider'\r\nimport { ThemeProvider } from 'styled-components/'\r\nimport SearchPage from './pages/search'\r\nimport ProfilePage from './pages/profile'\r\nimport DistrictPage from './pages/district'\r\nimport BattleGroundPage from './pages/battleground'\r\nimport NotfoundPage from './pages/notfound'\r\nimport ApolloClient from 'apollo-boost'\r\nimport { ApolloProvider } from 'react-apollo'\r\nimport theme, { styledComponentTheme } from 'ui/theme/main'\r\nimport './App.css'\r\nimport Box from '@material-ui/core/Box'\r\nimport styled from 'styled-components'\r\nimport SearchDrawer from 'components/search/SearchDrawer'\r\nimport Drawer from '@material-ui/core/Drawer'\r\nimport MobileAppBar from './components/molecules/MobileAppBar'\r\nimport { makeStyles } from '@material-ui/core/styles'\r\nimport drawerReducer from 'reducers/drawer'\r\nimport ContextStore, { drawerInitialState } from 'ContextStore'\r\n\r\nconst client = new ApolloClient({\r\n  uri: 'https://gql.opencultures.life/graphql',\r\n})\r\n\r\nconst useStyles = makeStyles({\r\n  paper: {\r\n    width: '100%',\r\n  },\r\n})\r\n\r\nconst ContentContainer = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    flex-direction: column;\r\n    width: 100%;\r\n  }\r\n`\r\n\r\nconst Root = styled(Box)`\r\n  && {\r\n    display: flex;\r\n    margin: auto;\r\n    overflow: hidden;\r\n  }\r\n`\r\n\r\nconst App = props => {\r\n  const [drawerState, drawerDispatch] = React.useReducer(\r\n    drawerReducer,\r\n    drawerInitialState\r\n  )\r\n\r\n  const classes = useStyles()\r\n\r\n  return (\r\n    <ApolloProvider client={client}>\r\n      <ThemeProvider theme={styledComponentTheme}>\r\n        <MuiThemeProvider theme={theme}>\r\n          <ContextStore.Provider\r\n            value={{\r\n              drawer: {\r\n                state: drawerState,\r\n                dispatch: drawerDispatch,\r\n              },\r\n            }}\r\n          >\r\n            <Root>\r\n              <ContentContainer>\r\n                <CssBaseline />\r\n                <MobileAppBar />\r\n                <main>\r\n                  <Switch>\r\n                    <Route exact path=\"/\" component={SearchPage} />\r\n                    <Route path=\"/profile/:id\" component={ProfilePage} />\r\n                    <Route\r\n                      path=\"/district/2019/:code\"\r\n                      component={BattleGroundPage}\r\n                    />\r\n                    <Route\r\n                      path=\"/district/:year/:code\"\r\n                      component={DistrictPage}\r\n                    />\r\n                    <Route component={NotfoundPage} />\r\n                  </Switch>\r\n                </main>\r\n              </ContentContainer>\r\n              <Drawer\r\n                anchor=\"right\"\r\n                open={drawerState.open}\r\n                variant=\"persistent\"\r\n                classes={{\r\n                  paper: classes.paper,\r\n                }}\r\n              >\r\n                <SearchDrawer />\r\n              </Drawer>\r\n            </Root>\r\n          </ContextStore.Provider>\r\n        </MuiThemeProvider>\r\n      </ThemeProvider>\r\n    </ApolloProvider>\r\n  )\r\n}\r\n\r\nexport default App\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport { HashRouter as Router } from 'react-router-dom'\r\nimport App from './App'\r\nimport './index.css'\r\n\r\nReactDOM.render(\r\n  <Router>\r\n    <App />\r\n  </Router>,\r\n  document.getElementById('root')\r\n)\r\n"],"sourceRoot":""}